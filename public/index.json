[{"authors":["admin"],"categories":null,"content":"Hi, I\u0026rsquo;m Amit Levinson, I\u0026rsquo;m an MA student for sociology \u0026amp; anthropology at Ben-Gurion University of the Negev. I currently live with my wife in Be\u0026rsquo;er Sheva, southern Israel. My interests include my thesis topic, drug markets and technology, other fields such as political participation, statistics and R. I\u0026rsquo;m currently working as a research assistant for Dr. Jennifer Oser from the Department of politics and government researching online and offline political participation. You can also find my full CV here.\nI opened this website so that I can have a reason to blog and challenge myself with new R analysis and visulizations; and to share what and how I analyze for others to use. Enjoy!\n","date":1554595200,"expirydate":-62135596800,"kind":"taxonomy","lang":"en","lastmod":1554595200,"objectID":"2525497d367e79493fd32b198b28f040","permalink":"/authors/admin/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/authors/admin/","section":"authors","summary":"Hi, I\u0026rsquo;m Amit Levinson, I\u0026rsquo;m an MA student for sociology \u0026amp; anthropology at Ben-Gurion University of the Negev. I currently live with my wife in Be\u0026rsquo;er Sheva, southern Israel. My interests include my thesis topic, drug markets and technology, other fields such as political participation, statistics and R. I\u0026rsquo;m currently working as a research assistant for Dr. Jennifer Oser from the Department of politics and government researching online and offline political participation.","tags":null,"title":"Amit Levinson","type":"authors"},{"authors":null,"categories":null,"content":"Flexibility This feature can be used for publishing content such as:\n Online courses Project or software documentation Tutorials  The courses folder may be renamed. For example, we can rename it to docs for software/project documentation or tutorials for creating an online course.\nDelete tutorials To remove these pages, delete the courses folder and see below to delete the associated menu link.\nUpdate site menu After renaming or deleting the courses folder, you may wish to update any [[main]] menu links to it by editing your menu configuration at config/_default/menus.toml.\nFor example, if you delete this folder, you can remove the following from your menu configuration:\n[[main]] name = \u0026quot;Courses\u0026quot; url = \u0026quot;courses/\u0026quot; weight = 50  Or, if you are creating a software documentation site, you can rename the courses folder to docs and update the associated Courses menu configuration to:\n[[main]] name = \u0026quot;Docs\u0026quot; url = \u0026quot;docs/\u0026quot; weight = 50  Update the docs menu If you use the docs layout, note that the name of the menu in the front matter should be in the form [menu.X] where X is the folder name. Hence, if you rename the courses/example/ folder, you should also rename the menu definitions in the front matter of files within courses/example/ from [menu.example] to [menu.\u0026lt;NewFolderName\u0026gt;].\n","date":1536451200,"expirydate":-62135596800,"kind":"section","lang":"en","lastmod":1536451200,"objectID":"59c3ce8e202293146a8a934d37a4070b","permalink":"/courses/example/","publishdate":"2018-09-09T00:00:00Z","relpermalink":"/courses/example/","section":"courses","summary":"Learn how to use Academic's docs layout for publishing online courses, software documentation, and tutorials.","tags":null,"title":"Overview","type":"docs"},{"authors":null,"categories":null,"content":"In this tutorial, I\u0026rsquo;ll share my top 10 tips for getting started with Academic:\nTip 1 Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum. Sed ac faucibus dolor, scelerisque sollicitudin nisi. Cras purus urna, suscipit quis sapien eu, pulvinar tempor diam. Quisque risus orci, mollis id ante sit amet, gravida egestas nisl. Sed ac tempus magna. Proin in dui enim. Donec condimentum, sem id dapibus fringilla, tellus enim condimentum arcu, nec volutpat est felis vel metus. Vestibulum sit amet erat at nulla eleifend gravida.\nNullam vel molestie justo. Curabitur vitae efficitur leo. In hac habitasse platea dictumst. Sed pulvinar mauris dui, eget varius purus congue ac. Nulla euismod, lorem vel elementum dapibus, nunc justo porta mi, sed tempus est est vel tellus. Nam et enim eleifend, laoreet sem sit amet, elementum sem. Morbi ut leo congue, maximus velit ut, finibus arcu. In et libero cursus, rutrum risus non, molestie leo. Nullam congue quam et volutpat malesuada. Sed risus tortor, pulvinar et dictum nec, sodales non mi. Phasellus lacinia commodo laoreet. Nam mollis, erat in feugiat consectetur, purus eros egestas tellus, in auctor urna odio at nibh. Mauris imperdiet nisi ac magna convallis, at rhoncus ligula cursus.\nCras aliquam rhoncus ipsum, in hendrerit nunc mattis vitae. Duis vitae efficitur metus, ac tempus leo. Cras nec fringilla lacus. Quisque sit amet risus at ipsum pharetra commodo. Sed aliquam mauris at consequat eleifend. Praesent porta, augue sed viverra bibendum, neque ante euismod ante, in vehicula justo lorem ac eros. Suspendisse augue libero, venenatis eget tincidunt ut, malesuada at lorem. Donec vitae bibendum arcu. Aenean maximus nulla non pretium iaculis. Quisque imperdiet, nulla in pulvinar aliquet, velit quam ultrices quam, sit amet fringilla leo sem vel nunc. Mauris in lacinia lacus.\nSuspendisse a tincidunt lacus. Curabitur at urna sagittis, dictum ante sit amet, euismod magna. Sed rutrum massa id tortor commodo, vitae elementum turpis tempus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean purus turpis, venenatis a ullamcorper nec, tincidunt et massa. Integer posuere quam rutrum arcu vehicula imperdiet. Mauris ullamcorper quam vitae purus congue, quis euismod magna eleifend. Vestibulum semper vel augue eget tincidunt. Fusce eget justo sodales, dapibus odio eu, ultrices lorem. Duis condimentum lorem id eros commodo, in facilisis mauris scelerisque. Morbi sed auctor leo. Nullam volutpat a lacus quis pharetra. Nulla congue rutrum magna a ornare.\nAliquam in turpis accumsan, malesuada nibh ut, hendrerit justo. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Quisque sed erat nec justo posuere suscipit. Donec ut efficitur arcu, in malesuada neque. Nunc dignissim nisl massa, id vulputate nunc pretium nec. Quisque eget urna in risus suscipit ultricies. Pellentesque odio odio, tincidunt in eleifend sed, posuere a diam. Nam gravida nisl convallis semper elementum. Morbi vitae felis faucibus, vulputate orci placerat, aliquet nisi. Aliquam erat volutpat. Maecenas sagittis pulvinar purus, sed porta quam laoreet at.\nTip 2 Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum. Sed ac faucibus dolor, scelerisque sollicitudin nisi. Cras purus urna, suscipit quis sapien eu, pulvinar tempor diam. Quisque risus orci, mollis id ante sit amet, gravida egestas nisl. Sed ac tempus magna. Proin in dui enim. Donec condimentum, sem id dapibus fringilla, tellus enim condimentum arcu, nec volutpat est felis vel metus. Vestibulum sit amet erat at nulla eleifend gravida.\nNullam vel molestie justo. Curabitur vitae efficitur leo. In hac habitasse platea dictumst. Sed pulvinar mauris dui, eget varius purus congue ac. Nulla euismod, lorem vel elementum dapibus, nunc justo porta mi, sed tempus est est vel tellus. Nam et enim eleifend, laoreet sem sit amet, elementum sem. Morbi ut leo congue, maximus velit ut, finibus arcu. In et libero cursus, rutrum risus non, molestie leo. Nullam congue quam et volutpat malesuada. Sed risus tortor, pulvinar et dictum nec, sodales non mi. Phasellus lacinia commodo laoreet. Nam mollis, erat in feugiat consectetur, purus eros egestas tellus, in auctor urna odio at nibh. Mauris imperdiet nisi ac magna convallis, at rhoncus ligula cursus.\nCras aliquam rhoncus ipsum, in hendrerit nunc mattis vitae. Duis vitae efficitur metus, ac tempus leo. Cras nec fringilla lacus. Quisque sit amet risus at ipsum pharetra commodo. Sed aliquam mauris at consequat eleifend. Praesent porta, augue sed viverra bibendum, neque ante euismod ante, in vehicula justo lorem ac eros. Suspendisse augue libero, venenatis eget tincidunt ut, malesuada at lorem. Donec vitae bibendum arcu. Aenean maximus nulla non pretium iaculis. Quisque imperdiet, nulla in pulvinar aliquet, velit quam ultrices quam, sit amet fringilla leo sem vel nunc. Mauris in lacinia lacus.\nSuspendisse a tincidunt lacus. Curabitur at urna sagittis, dictum ante sit amet, euismod magna. Sed rutrum massa id tortor commodo, vitae elementum turpis tempus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean purus turpis, venenatis a ullamcorper nec, tincidunt et massa. Integer posuere quam rutrum arcu vehicula imperdiet. Mauris ullamcorper quam vitae purus congue, quis euismod magna eleifend. Vestibulum semper vel augue eget tincidunt. Fusce eget justo sodales, dapibus odio eu, ultrices lorem. Duis condimentum lorem id eros commodo, in facilisis mauris scelerisque. Morbi sed auctor leo. Nullam volutpat a lacus quis pharetra. Nulla congue rutrum magna a ornare.\nAliquam in turpis accumsan, malesuada nibh ut, hendrerit justo. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Quisque sed erat nec justo posuere suscipit. Donec ut efficitur arcu, in malesuada neque. Nunc dignissim nisl massa, id vulputate nunc pretium nec. Quisque eget urna in risus suscipit ultricies. Pellentesque odio odio, tincidunt in eleifend sed, posuere a diam. Nam gravida nisl convallis semper elementum. Morbi vitae felis faucibus, vulputate orci placerat, aliquet nisi. Aliquam erat volutpat. Maecenas sagittis pulvinar purus, sed porta quam laoreet at.\n","date":1557010800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1557010800,"objectID":"74533bae41439377bd30f645c4677a27","permalink":"/courses/example/example1/","publishdate":"2019-05-05T00:00:00+01:00","relpermalink":"/courses/example/example1/","section":"courses","summary":"In this tutorial, I\u0026rsquo;ll share my top 10 tips for getting started with Academic:\nTip 1 Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum. Sed ac faucibus dolor, scelerisque sollicitudin nisi. Cras purus urna, suscipit quis sapien eu, pulvinar tempor diam. Quisque risus orci, mollis id ante sit amet, gravida egestas nisl. Sed ac tempus magna. Proin in dui enim.","tags":null,"title":"Example Page 1","type":"docs"},{"authors":null,"categories":null,"content":"Here are some more tips for getting started with Academic:\nTip 3 Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum. Sed ac faucibus dolor, scelerisque sollicitudin nisi. Cras purus urna, suscipit quis sapien eu, pulvinar tempor diam. Quisque risus orci, mollis id ante sit amet, gravida egestas nisl. Sed ac tempus magna. Proin in dui enim. Donec condimentum, sem id dapibus fringilla, tellus enim condimentum arcu, nec volutpat est felis vel metus. Vestibulum sit amet erat at nulla eleifend gravida.\nNullam vel molestie justo. Curabitur vitae efficitur leo. In hac habitasse platea dictumst. Sed pulvinar mauris dui, eget varius purus congue ac. Nulla euismod, lorem vel elementum dapibus, nunc justo porta mi, sed tempus est est vel tellus. Nam et enim eleifend, laoreet sem sit amet, elementum sem. Morbi ut leo congue, maximus velit ut, finibus arcu. In et libero cursus, rutrum risus non, molestie leo. Nullam congue quam et volutpat malesuada. Sed risus tortor, pulvinar et dictum nec, sodales non mi. Phasellus lacinia commodo laoreet. Nam mollis, erat in feugiat consectetur, purus eros egestas tellus, in auctor urna odio at nibh. Mauris imperdiet nisi ac magna convallis, at rhoncus ligula cursus.\nCras aliquam rhoncus ipsum, in hendrerit nunc mattis vitae. Duis vitae efficitur metus, ac tempus leo. Cras nec fringilla lacus. Quisque sit amet risus at ipsum pharetra commodo. Sed aliquam mauris at consequat eleifend. Praesent porta, augue sed viverra bibendum, neque ante euismod ante, in vehicula justo lorem ac eros. Suspendisse augue libero, venenatis eget tincidunt ut, malesuada at lorem. Donec vitae bibendum arcu. Aenean maximus nulla non pretium iaculis. Quisque imperdiet, nulla in pulvinar aliquet, velit quam ultrices quam, sit amet fringilla leo sem vel nunc. Mauris in lacinia lacus.\nSuspendisse a tincidunt lacus. Curabitur at urna sagittis, dictum ante sit amet, euismod magna. Sed rutrum massa id tortor commodo, vitae elementum turpis tempus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean purus turpis, venenatis a ullamcorper nec, tincidunt et massa. Integer posuere quam rutrum arcu vehicula imperdiet. Mauris ullamcorper quam vitae purus congue, quis euismod magna eleifend. Vestibulum semper vel augue eget tincidunt. Fusce eget justo sodales, dapibus odio eu, ultrices lorem. Duis condimentum lorem id eros commodo, in facilisis mauris scelerisque. Morbi sed auctor leo. Nullam volutpat a lacus quis pharetra. Nulla congue rutrum magna a ornare.\nAliquam in turpis accumsan, malesuada nibh ut, hendrerit justo. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Quisque sed erat nec justo posuere suscipit. Donec ut efficitur arcu, in malesuada neque. Nunc dignissim nisl massa, id vulputate nunc pretium nec. Quisque eget urna in risus suscipit ultricies. Pellentesque odio odio, tincidunt in eleifend sed, posuere a diam. Nam gravida nisl convallis semper elementum. Morbi vitae felis faucibus, vulputate orci placerat, aliquet nisi. Aliquam erat volutpat. Maecenas sagittis pulvinar purus, sed porta quam laoreet at.\nTip 4 Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum. Sed ac faucibus dolor, scelerisque sollicitudin nisi. Cras purus urna, suscipit quis sapien eu, pulvinar tempor diam. Quisque risus orci, mollis id ante sit amet, gravida egestas nisl. Sed ac tempus magna. Proin in dui enim. Donec condimentum, sem id dapibus fringilla, tellus enim condimentum arcu, nec volutpat est felis vel metus. Vestibulum sit amet erat at nulla eleifend gravida.\nNullam vel molestie justo. Curabitur vitae efficitur leo. In hac habitasse platea dictumst. Sed pulvinar mauris dui, eget varius purus congue ac. Nulla euismod, lorem vel elementum dapibus, nunc justo porta mi, sed tempus est est vel tellus. Nam et enim eleifend, laoreet sem sit amet, elementum sem. Morbi ut leo congue, maximus velit ut, finibus arcu. In et libero cursus, rutrum risus non, molestie leo. Nullam congue quam et volutpat malesuada. Sed risus tortor, pulvinar et dictum nec, sodales non mi. Phasellus lacinia commodo laoreet. Nam mollis, erat in feugiat consectetur, purus eros egestas tellus, in auctor urna odio at nibh. Mauris imperdiet nisi ac magna convallis, at rhoncus ligula cursus.\nCras aliquam rhoncus ipsum, in hendrerit nunc mattis vitae. Duis vitae efficitur metus, ac tempus leo. Cras nec fringilla lacus. Quisque sit amet risus at ipsum pharetra commodo. Sed aliquam mauris at consequat eleifend. Praesent porta, augue sed viverra bibendum, neque ante euismod ante, in vehicula justo lorem ac eros. Suspendisse augue libero, venenatis eget tincidunt ut, malesuada at lorem. Donec vitae bibendum arcu. Aenean maximus nulla non pretium iaculis. Quisque imperdiet, nulla in pulvinar aliquet, velit quam ultrices quam, sit amet fringilla leo sem vel nunc. Mauris in lacinia lacus.\nSuspendisse a tincidunt lacus. Curabitur at urna sagittis, dictum ante sit amet, euismod magna. Sed rutrum massa id tortor commodo, vitae elementum turpis tempus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean purus turpis, venenatis a ullamcorper nec, tincidunt et massa. Integer posuere quam rutrum arcu vehicula imperdiet. Mauris ullamcorper quam vitae purus congue, quis euismod magna eleifend. Vestibulum semper vel augue eget tincidunt. Fusce eget justo sodales, dapibus odio eu, ultrices lorem. Duis condimentum lorem id eros commodo, in facilisis mauris scelerisque. Morbi sed auctor leo. Nullam volutpat a lacus quis pharetra. Nulla congue rutrum magna a ornare.\nAliquam in turpis accumsan, malesuada nibh ut, hendrerit justo. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Quisque sed erat nec justo posuere suscipit. Donec ut efficitur arcu, in malesuada neque. Nunc dignissim nisl massa, id vulputate nunc pretium nec. Quisque eget urna in risus suscipit ultricies. Pellentesque odio odio, tincidunt in eleifend sed, posuere a diam. Nam gravida nisl convallis semper elementum. Morbi vitae felis faucibus, vulputate orci placerat, aliquet nisi. Aliquam erat volutpat. Maecenas sagittis pulvinar purus, sed porta quam laoreet at.\n","date":1557010800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1557010800,"objectID":"1c2b5a11257c768c90d5050637d77d6a","permalink":"/courses/example/example2/","publishdate":"2019-05-05T00:00:00+01:00","relpermalink":"/courses/example/example2/","section":"courses","summary":"Here are some more tips for getting started with Academic:\nTip 3 Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum. Sed ac faucibus dolor, scelerisque sollicitudin nisi. Cras purus urna, suscipit quis sapien eu, pulvinar tempor diam. Quisque risus orci, mollis id ante sit amet, gravida egestas nisl. Sed ac tempus magna. Proin in dui enim. Donec condimentum, sem id dapibus fringilla, tellus enim condimentum arcu, nec volutpat est felis vel metus.","tags":null,"title":"Example Page 2","type":"docs"},{"authors":[],"categories":[],"content":"\rIntroduction\rIsrael had its 3rd election within 12 months on March 2, 2020. This is because our Knesset - Hebrew term for house of representatives - wasn’t able to form or hold a government after each of the previous elections. As I won’t get into the politics of why they didn’t succeed in forming one (get it? politics 😉), I do want to take the opportunity and analyze some tweets posted in the time before and after the elections.\nWhen we think of a data aggregating tweets, many questions arise - who, what, when, where and more about our data. Namely, with the collected data I want to answer the following questions:\nWhat was the frequency of tweets associated with the word ‘elections’?\rWho tweeted the most?\rWhat was the most common #Hashtag tweeted?\rWhich tweet was most liked and which was retweeted the most?\rWhat were the most common words and bigrams (two words) in tweets?\r\r\rGathering the data \rTwitter’s API allows scraping 6-9 days back for free. Therefore, I scraped the data already on March 7, 2020 and saved it for later use.\nLet’s start with the packages we’ll use:\nlibrary(rtweet)\rlibrary(tidyverse)\rlibrary(tidytext)\rlibrary(igraph)\rlibrary(hrbrthemes)\rlibrary(ggraph)\rlibrary(extrafont)\rI could use a consistent plot theme throughout the post but I’ll probably be editing each one a bit, while also some are not our regular graphs. With that said, There are some tweaks that will be consistent acorss several of the plots. Therefore, let’s create a theme function as a supplement to all other theme arguments I’ll use that will save a few lines of code:\nmini_theme \u0026lt;- function(family = \u0026quot;Roboto Condensed\u0026quot;, tsize = 16) {\rtheme_classic() +\rtheme(text = element_text(family = family),\raxis.ticks = element_blank(),\raxis.line = element_blank(),\rplot.title = element_text(size = tsize))}\rNext we’ll gather the tweets we need:\nelections_raw \u0026lt;- search_tweets(\u0026quot;בחירות\u0026quot;, n = 18000, retryonratelimit = TRUE)\rTo gather the tweets we can use the {rtweet} package which is amazing for collecting Twitter data (Check out its website). As I mentioned earlier, I already scraped the data a few days after the elections but left the command here to show what we did and how easy it is to do it. I searched only one term, ‘elections’ in Hebrew, and rtweet gathered all tweets containing that word.\nWhat did our search yield? Let’s have a look:\ndim(elections)\r## [1] 16560 90\r16,560 rows and 90 columns! As we can see, the {rtweet} package brings back a lot of information (check out the .rds file here)!\nSome Caveats:\rBefore we begin, I will say this post doesn’t aim to be representative of the discussions that were held during the election period. As a matter of fact, nor does it aim to be representative of the twitter discussions surrounding the elections. this is due to two main reasons:\nTwitter isn’t common in Israel at all. I’m not sure what’s the usage rate but it’s definitely not representative of the Israeli population.\n\rI searched for only one word - elections (in Hebrew) - which yielded some 16560 tweets. This is definitely not a large enough pool of tweets to claim for representation.\n\r\rWith that said, the data gathered provides an opportunity to look at some Twitter data from the election period and motivate others to use the {rtweet} package, so why not give it a go.\n\r\rTweet frequency\rFirst, let’s see how the tweets distribute across the time span we searched for. we can create a quick time plot using the ts_plot() argument from the {rtweet} package:\nelections %\u0026gt;% ts_plot(\u0026quot;2 hours\u0026quot;)+\rgeom_line(size = 1, color = \u0026quot;black\u0026quot;)+\rmini_theme()+\rscale_x_datetime(date_breaks = \u0026quot;1 day\u0026quot;,date_labels = \u0026quot;%d %b\u0026quot;)+\rlabs(x= NULL, y = NULL,\rtitle = \u0026quot;Frequency of tweets throughout the Israeli elections week\u0026quot;,\rsubtitle = \u0026quot;Tweets aggregated by two-hour interval. only tweets with\\nthe word \u0026#39;elections\u0026#39; (in Hebrew) were gathered\u0026quot;)+\rgeom_text(aes(x = as.POSIXct(\u0026quot;2020-03-02 23:00:00\u0026quot;), y = 435, label = \u0026quot;10 PM:\\nClosing of\\npolls\u0026quot;),\rhjust = 0, size = 3, family = \u0026quot;Roboto Condensed\u0026quot;)+\rgeom_vline(xintercept = as.POSIXct(\u0026quot;2020-03-02 22:00\u0026quot;),linetype = \u0026quot;dashed\u0026quot;, size = 0.5, color = \u0026quot;black\u0026quot;)+\rtheme(plot.subtitle = element_text(color = \u0026quot;gray75\u0026quot;))\rInteresting - we see the number of tweets during the closing time is equivalent to that of midday on March 4th. Most of the votes were counted by the end of March 3rd, so I can’t really put my finger on what this jump represents. After all, I collected tweets containing our word so it could have been that many people tweeted that specific term in that time slot. Anyway, I wasn’t able to find anything interesting that happened on the news that day but feel free to explore and offer suggestions.\n\rUsers with most tweets\rNext, let’s look at who tweeted the most:\nelections %\u0026gt;% count(screen_name, sort = T) %\u0026gt;% slice(1:15) %\u0026gt;% mutate(screen_name = reorder(screen_name,n)) %\u0026gt;% ggplot(aes(x= screen_name, y= n))+\rgeom_col(fill = \u0026quot;gray70\u0026quot;)+\rcoord_flip()+\rscale_y_continuous(breaks = seq(0,180, 30), labels = seq(0,180,30))+\rlabs(x = \u0026quot;Screen name\u0026quot;, y = \u0026quot;Number of tweets\u0026quot;, title = \u0026quot;Top 15 users tweeting the word \u0026#39;elections\u0026#39;\u0026quot;)+\rmini_theme()+\rtheme(text = element_text(family = \u0026quot;Calibri\u0026quot;),\raxis.text = element_text(size = 12),\raxis.title.y = element_blank())\rWe see that many news companies tweeted a lot using the word ‘elections’: ‘newisrael13’, ‘kann_news’, ‘MaarivOnline’, ‘RotterNews’, ‘bahazit_news’, ‘RotterNet’. I personnaly don’t recognize the rest, but on the other hand I use Twitter mostly to follow R and academic related tweets, not necessarily Israeli politics.\n\rCommon Hashtags\rWhen using the {rtweet} package to gather twitter data, one of the variables collected is the hashtags used in tweets. Although it doesn’t require too many lines of code to extract hashtags out of text, I think this is an amazing feature that shows the effort and details Michael W. Kearney and contributors put into the package.\nAccording to Wikipedia, a ‘Hashtag’ “is a type of metadata tag used on social networks such as Twitter and other microblogging services.”, that basically tags the message with a specific theme. This helps to see trends and themes in a macro level.\nOK then, let’s see what we have:\nhashtags \u0026lt;- elections %\u0026gt;% select(hashtags) %\u0026gt;% unlist() %\u0026gt;% as.tibble() %\u0026gt;% mutate(value = tolower(value)) %\u0026gt;% count(value, name = \u0026quot;Count\u0026quot;, sort = T) %\u0026gt;%\rmutate(value = reorder(value, Count),\riscorona = ifelse(value == \u0026quot;קורונה\u0026quot; | value == \u0026quot;coronavirus\u0026quot;, \u0026quot;y\u0026quot;, \u0026quot;n\u0026quot;)) %\u0026gt;% filter(!is.na(value)) %\u0026gt;% slice(1:20)\rggplot(data = hashtags, aes(x = Count, y = value, fill = iscorona))+\rgeom_col(show.legend = FALSE)+\rscale_fill_manual(values = c(y = \u0026quot;#1DA1F2\u0026quot;, n = \u0026quot;gray70\u0026quot;))+\rlabs(y = NULL, x = \u0026quot;Number of Tweets\u0026quot;, title = \u0026quot;Top 20 Hashtags addressing the Israeli elections\u0026quot;)+\rmini_theme()+\rtheme(text = element_text(family = \u0026quot;Calibri\u0026quot;),\raxis.text = element_text(size = 12))\rThe tweets include pretty much what we expect - hashtags about the elections - with the two leading ones being ‘elections’ and ‘elections2020’. We also see a peculiar hashtag ‘right_following_right_people’, and others such as ‘Netanyahu’ (the Prime minister at the time), ‘Israel’ and others.\nI highlighted in blue an interesting hashtag at the time - Corona (in hebrew) and coronavirus. The elections were held on March 2, 2020, a little bit after the first cases reached Israel. Little did we know how it will affect us (I’m finalzing this post on April 18, 2020, and only now we’re starting to get back to routine. Slowly)\n\rMost liked and retweeted\rLet’s have a look at which tweet was most liked. Twitter doesn’t define it as ‘likes’ but as ‘favorite’, or at least in the data that is collected through the {rtweet} package. Since I will want to gather the most of something - both favorite and later retweeted - I’ll create a function that will minimize re-writing the code.\nThe function takes in a variable, reorders our dataset according to the variable we declared, extracts the first row and then pulls (extracts) the status id of that tweet. Lastly, the blogdown::shortcode enables to embed tweets, youtube videos and more into a blogdown post such as this, so we end the function by inserting our status id into that. For those just getting into functions notice that within the arrange argument we insert our variable in two curly brackets {{}}. This is a powerful feature of {rlang} when you want to manipulate a variable in a dataframe within a function. You can read more about that here.\nget_most \u0026lt;- function(var){\relections %\u0026gt;% arrange(desc({{var}})) %\u0026gt;% .[1,] %\u0026gt;% pull(status_id) %\u0026gt;% blogdown::shortcode(\u0026#39;tweet\u0026#39;,.)\r}\rNow Let’s see which tweet was most liked during that week:\n\rיותר מהכל, אני שמח שלא יהיו עוד בחירות בשביל המשפחה שלי שסבלה בגבורה שנה ורבע. רעות עברי וענר 😍\n\u0026mdash; עמית סגל Amit Segal (@amit_segal) March 2, 2020  \rThe tweet is by ‘Amit Segal’ - an Israeli news reporter - and it says (my translation):\n\r“More than anything, I’m glad there won’t be another elections for my family that suffered in honors a year and a quarter. Reut, Ivri and Aner 😍”\n\rHa, interestingly he wrote it before the end of the elections, hopefully he’s right!\nNow let’s look at the most re-tweeted tweet:\n\rאם ההקלטה של יועצו של גנץ מבושלת ושקרית (כדברי גנץ עכשיו), אז למה גנץ פיטר אותו?\nיועצו של גנץ פוטר בגלל שאמר את האמת שכולם יודעים: גנץ לא יכול להיות ראש ממשלה. אנחנו כן. עוד 2 מנדטים לליכוד ואנחנו מוציאים את המדינה מהפלונטר, מונעים עוד בחירות ומקימים ממשלה\n\u0026mdash; Benjamin Netanyahu (@netanyahu) February 28, 2020  \rThe tweet is by Benjamin Netanyahu, at the time the prime minister of Israel, who writes:\n\r“If the recording of Gantz’s advisor is orcherstrated and fabricated (according to Gantz’s words just now), why did Gantz fire him? Gantz’s advisor was fired because he said the truth everyone knows: Gantz can’t be a prime minister. We can. 2 more mandates to the Likkud and we are taking the country out of the plonter, preventing another election and form a government”\n\rThis came after the exposure of a secret recording of Gantz in a closed meeting, A few days before election day.\n\rWordcloud and bigrams\rLet’s have a look at two more text-related analyses:\nA word-cloud\n\rBigrams (two-words) from our text\r\rWe could try out more algorthims but I’ll save them for a different post (feel free to try on your own).\nWordcloud\rIn order to tackle the wordcloud, I’ll break up all the tweets into single words, filter any Hebrew stop words (file found online) and all English words. The decision to filter English words is mainly because I’m interested in the Hebrew sentences, but also because most the common English words used in our data are those of Twitter user names cited when replying to a tweet:\nhe_stopwords \u0026lt;- read_tsv(\u0026quot;https://raw.githubusercontent.com/gidim/HebrewStopWords/master/heb_stopwords.txt\u0026quot;, col_names = \u0026quot;word\u0026quot;)\relection_token \u0026lt;- elections %\u0026gt;% unnest_tokens(word, text) %\u0026gt;% select(word) %\u0026gt;%\ranti_join(he_stopwords) %\u0026gt;% count(word, sort = T) %\u0026gt;%\rfilter(!grepl(\u0026quot;([a-z]+|בחירות)\u0026quot;, word), n\u0026gt;= 150)\rNow we can create a wordcloud of words appearing more than 150 times using {wordcloud2} package1:\n\nwordcloud2::wordcloud2(election_token, color = \u0026quot;#1DA1F2\u0026quot;, shape = \u0026quot;circle\u0026quot;)\rWhat we can see is many of the words we’d expect: Political candidates, government, fourth (in the context of fourth elections), partis’ names and more. I’ll provide a more thorough discussion following our bigram plot below, as I believe it addresses many of the same words.\n\rBigram of used words\rLike we did before, we can break up our text data into two word observations, also known as bigrams. In order to account for all combinations, we break up the sentence to fit all possible options. For example, assume we have the following sentence:\n“Danny went to vote yesterday”\nUsing the unnest_tokens we’ll break the sentence into the following bigrams:\nDanny went\n\rwent to\n\rto vote\n\rvote yesterday\r\rWhich gives us all possible options. We will also include two columns consisting of the bigram broken up into single words. This will help in filtering out bigrams containing Hebrew stop words or English words. I’ll not run through the following code but instead will point you to David Ronbinson \u0026amp; Julia Silge ‘Text Mining with R’ Book for further reading.\nelec_bigram \u0026lt;- elections %\u0026gt;%\rselect(text) %\u0026gt;% unnest_tokens(bigram, text, token = \u0026quot;ngrams\u0026quot;, n = 2) %\u0026gt;%\rseparate(bigram, into = c(\u0026quot;word1\u0026quot;, \u0026quot;word2\u0026quot;), sep = \u0026quot; \u0026quot;, remove = FALSE) %\u0026gt;% filter(!word1 %in% he_stopwords$word,\r!word2 %in% he_stopwords$word,\r!grepl(\u0026quot;([a-z]+|בחירות)\u0026quot;, bigram)) %\u0026gt;% count(word1, word2, sort = T) %\u0026gt;% slice(1:45) %\u0026gt;%\rgraph_from_data_frame()\rp_arrow \u0026lt;- arrow(type = \u0026quot;closed\u0026quot;, length = unit(.1, \u0026quot;inches\u0026quot;))\rggraph(elec_bigram, layout = \u0026quot;fr\u0026quot;)+\rgeom_edge_link(aes(edge_alpha = n), arrow = p_arrow, end_cap = circle(.04, \u0026quot;inches\u0026quot;), show.legend = FALSE)+\rgeom_node_point(color = \u0026quot;lightblue\u0026quot;, size = 3)+\rgeom_node_text(aes(label = name), vjust = 1, hjust = 1, family = \u0026quot;Calibri\u0026quot;)+\rtheme_void()+\rlabs(title = \u0026quot;Bigram from Twitter data\u0026quot;)+\rtheme(text = element_text(family = \u0026quot;Calibri\u0026quot;),\rplot.title = element_text(hjust = 0.5 , face = \u0026quot;bold\u0026quot;, size = 18))\r\rFigure 1: Graph excludes Hebrew stop words and the word ‘elections’\r\r\nHow should we read this graph?\nFirst off, We only plotted the 45 most common bigrams (out of 100,000+). Every word is connected to another word with an arrow pointing to a given direction. The direction to which the arrow points is the way to read that bigram. In addition, bolder lines represent a higher frequency of that bigram throughout all our text.\nFor example, on the bottom of our graph we see the number ‘2’ connected to the words ‘mandates’ and ‘campagin’. The direction of the arrow signals that we should read the bigram as ‘2 mandates’ and ‘2 campagins’.\nWhat does this all mean?\n\rWe have discussions regarding the number of chairs a govenrment will have (62/61/60/58) connected to mentions of the number of election campaigns (2/3) we had, discussions of a united and/or minimal government and the forming of one in general.\n\rWe see mentions of individuals such as ‘Yair Lapid’, “Amir peretz”, “Benjamin Netanyahu”, “Amit Segal” (Both we discussed earlier), “Natan Eshel”, but no mention of the main candidate running against Netanyahu - “Benny Gantz”. That’s actually kind of odd, but more on that in a minute.\n\rWe also see mentions of political parties such as “Meretz”, “Gesher” and “Labor” who ran together this time around, “Otzma Yehudit”, “United Torah Judaism”, and the “Joint List”. There’s no mention of the two leading parties - “Kahol Lavan” \u0026amp; “The Likkud”., despite the mentioning of the latter’s leader.\n\rMentions of Netanyahu’s indicment and the personal law connected to him.\n\rMentions I’d categorize as ‘other’ such as “Terrorist supporters”, “Will of the people”, “Fake news”, “Last year”, etc.\r\r\rActaully, this turned out more interesting than I thought. Several questions arose while looking at it: Several words are missing such as the main parties names (Likkud \u0026amp; Kahol-Lavan), The leading oponent running against Benjamin Netanyahu - Benny Gantz - and other questions such as with whom are specific terms associated. Before we close up I’ll look at one question that troubles me - Why doesn’t Gantz appear in our list 😨?\nBenny Gantz’s disappearance\rIn order to see why Benny Gantz doesn’t appear in our bigram plot I’ll do the following: I’ll break the text into bigrams and filter to have only the bigrams containing the word Gantz. Once we have that we can see why he doesn’t appear in our bigram plot despite appearing in our wordcloud.\nBefore I run the analysis and give you the answer think for a moment - What was the process of coming up with the bigram? If I chose only the 50 most frequent bigrams, why would a word that appears many times in our text not appear in our bigram list? Alternatively, did we filter anything along the way? Maybe even give the previous chunk another glance before I answer it.\nLet’s have a look:\ngantz \u0026lt;-elections %\u0026gt;%\rselect(text) %\u0026gt;% unnest_tokens(bigram, text, token = \u0026quot;ngrams\u0026quot;, n = 2) %\u0026gt;%\rseparate(bigram, into = c(\u0026quot;word1\u0026quot;, \u0026quot;word2\u0026quot;), sep = \u0026quot; \u0026quot;, remove = FALSE) %\u0026gt;% filter(word1 %in% \u0026quot;גנץ\u0026quot; |\rword2 %in% \u0026quot;גנץ\u0026quot;,\r!grepl(\u0026quot;([a-z]+|בחירות)\u0026quot;, bigram))\rThe code is similar to what we did earlier only this time we left bigrams that match the word we want - bigrams containing the word Gantz. Now that we have our list of bigrams, let’s look at the count of bigrams containing the word גנץ (‘Gantz’):\ngantz %\u0026gt;% count(bigram, sort = T)\r## # A tibble: 978 x 2\r## bigram n\r## \u0026lt;chr\u0026gt; \u0026lt;int\u0026gt;\r## 1 של גנץ 160\r## 2 בני גנץ 138\r## 3 גנץ לא 90\r## 4 על גנץ 70\r## 5 את גנץ 69\r## 6 עם גנץ 61\r## 7 אם גנץ 41\r## 8 גנץ היה 25\r## 9 גנץ או 19\r## 10 גנץ ליברמן 19\r## # ... with 968 more rows\rAHA! Now I see what happened. The first bigram is a stop word and the word Gantz (‘Of Gantz’). The second bigram should have been included as it is Gantz’s full name - Benny Gantz, which appears 138 times.\nSo, why has it been filtered? This is a great question which we can answer if we look at our stop words we initially used. Let’s see if it has the word בני (‘benny’ in Hebrew):\nhe_stopwords %\u0026gt;% filter(word == \u0026quot;בני\u0026quot;)\r## # A tibble: 1 x 1\r## word ## \u0026lt;chr\u0026gt;\r## 1 בני\rYes it does. At the time of writing this blog post it leaves me in a dilemma - Should I change the stop words file I used to a different one or maybe create my own? Or should I continue as is? I think leaving it will teach me (and hopefully whoever read this far) a valuable lesson of always checking your stop words. In a different context the specific bigram wouldn’t have got me thinking, but here it didn’t make sense that our leading candidate was filtered, thus my inquire into what happened. In hebrew the word Benny also means ‘my son’, which I wouldn’t describe as a stop word but whoever made the dataset I guess did.\nIf you wish to give it a try yourself, you can find the data in the form of an .rds or smaller .csv (excludes list columns) in my github repository.\nWell then, that’s all for now folks! And remember, make sure to validate your stop words dataset!\r\r\r\r\rThe function wordcloud2 we wrote wasn’t actually run because it renders an html object which distorts the post. Instead I used the webshot of our rendered html file, read more about that here.↩\n\r\r\r","date":1587340800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1587367782,"objectID":"406620afd26c1a573f7886c332ca3564","permalink":"/2020/04/20/israeli-elections-on-twitter/","publishdate":"2020-04-20T00:00:00Z","relpermalink":"/2020/04/20/israeli-elections-on-twitter/","section":"post","summary":"Analyzing tweets from the the Israeli elections week","tags":[],"title":"Israeli elections on Twitter","type":"post"},{"authors":[],"categories":["R"],"content":"\rWhat is TidyTuesday?\r\r“A weekly data project aimed at the R ecosystem. As this project was borne out of the R4DS Online Learning Community and the R for Data Science textbook, an emphasis was placed on understanding how to summarize and arrange data to make meaningful charts with ggplot2, tidyr, dplyr, and other tools in the tidyverse ecosystem. However, any code-based methodology is welcome - just please remember to share the code used to generate the results.”\n\rYou can read more about it here.\nBasically, every week the R4DS community publishes a new data set where the R community (or any code-based methdogology) is welcome to analyze and visualize the data.\rWhen I started learning R I saw it as a great opportunity to practice plotting and analzying various datasets; it’s what get me motivated and fascinated with R. Every week you’re challenged with a new data set and get to see how others have analyzed it.\nWhenever I have some free time I like to join in and give it a go. If you’re looking to get some practice or enjoy analyzing the same data set as others - Join the party, there’s much to learn!\n\n\rPlots\rBelow are graphs I made, organized in a descending order by date. Some I’m more proud of than others, but I choose to display all of them in case someone finds anything useful 😄\r\n16.04.2020\rLink to code\n\r17.03.2020\rLink to code\n\r06.03.2020\rLink to code | Try the app\n\r20.01.2020\rLink to code\n\r22.12.2019\rLink to code\n\r11.12.2019\rLink to code\n\r5.12.2019\rLink to code\n\r20.11.2019\rLink to code\n\r6.11.2019\rLink to code\r\r31.10.2019\rLink to code\n\r22.10.2019\rLink to code\n\n\r9.10.2019\rLink to code\r\n\r6.10.2019\rLink to code\r\n\r28.9.2019\rLink to code\n\n\r22.9.2019\rLink to code\nBack to top\n\r\r","date":1586995200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1587049835,"objectID":"22679f7a35f1c0d6138a196711b067c2","permalink":"/2020/04/16/the-tidytuesday-project/","publishdate":"2020-04-16T00:00:00Z","relpermalink":"/2020/04/16/the-tidytuesday-project/","section":"post","summary":"Visualizations from the Tidytuesday project - A weekly data project intended to practice summarizing, arranging and visualizing data.","tags":[],"title":"The Tidytuesday project","type":"post"},{"authors":[],"categories":["talk"],"content":"\rR is an amazing tool for preparing and visualizing data. As political activists we want to provide our readers with information that will influence and motivate them to act. The talk outlines how I believe R can empower individuals to work with data in an efficient and aesthetic way.\nYou can find a static example of knitting a document with parameters under the folder ‘rmarkdown_eg’ in the code repository. Rmarkdown’s ability to render documents is something I found extremly advantageous over other programs such as SPSS, a statistical program commonly taught in the social science. The slides were given to a group of fellows of the program Israel-2050 which I was a member of in 2017. This is not a hands-on learning session but an exposure to some of R’s abilities I find fascinating and helpful for those wanting to work with data effectively.\n","date":1586869200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1560819601,"objectID":"2489080d41fe6a46f9d0995232819bf0","permalink":"/talk/israel-2050/","publishdate":"2020-04-17T00:00:00Z","relpermalink":"/talk/israel-2050/","section":"talk","summary":" ","tags":["talk"],"title":"Wrangling and Visualizing Data in R","type":"talk"},{"authors":[],"categories":[],"content":"\r\rTL;DR Instead of each time searching for an id in the xlsx template the university provides we make our own xlsx and merge between the two. I then run through two options of either saving the new data frame as an .xlsx using the {xlsx} package, and I show another option where I extract the new column I need using write_clip from the {clipr} package.\n\r“Progress isn’t made by early risers. It’s made by lazy men trying to find easier ways to do something.”  ― Robert Heinlein\n\rWhat’s the story?\rThe other day I had to update students’ exams into a blank excel file. Every course exam each student gets an exam id. Their id is comprised from a number / number, for example, 26/1; 1/1; 42/15 and so forth. In our course of up to 70 students the left number goes all the way to the number of students in the exam class, and the right number goes up to 15 or 20 and starts again from 1.\nThis would make it easy to insert the grade for each id into the excel file that is already organized. However, since this is a new system and I was waiting to get access to download the excel I decided to open a new spreadsheet instead. Also, writing the id instead of looking it up in the excel file each time can save, in my opinion, a little time of searching.\nSo we have our spreadsheet which is not sorted, and we have the university’s spreadsheet which is sorted - how are we going to sync between them, considering our id column we wrote is recognized as a character class? I know, let’s turn to R1.\n\rLooking at our data\rLet’s start off with loading our packages:\nlibrary(tidyverse)\r# For reading xlsx files\rlibrary(readxl)\r# To nicely display the tables in the following paragraph\rlibrary(kableExtra)\rlibrary(knitr)\rNow let’s read both files: Our spreadsheet with just the id and grade of each student we wrote in, and the other spreadsheet with the students’ id and a numerical vector to sort by that the university provides.\nmessy \u0026lt;- read_excel(\u0026quot;messy_grades.xlsx\u0026quot;)\rclean \u0026lt;- read_excel(\u0026quot;clean.xlsx\u0026quot;)\rThis gives us the following tables where on the left we have our messy table we wrote and on the right our clean table we want to merge to:\n\r\rid\r\rgrade\r\r\r\r\r\r67/13\r\r94\r\r\r\r56/2\r\r90\r\r\r\r68/14\r\r84\r\r\r\r63/9\r\r100\r\r\r\r55/1\r\r89\r\r\r\r62/8\r\r97\r\r\r\r\r\r\rid\r\rparticipated\r\rnumber_for_sorting\r\r\r\r\r\r1/1\r\rV\r\r1\r\r\r\r2/2\r\rV\r\r2\r\r\r\r3/3\r\rV\r\r3\r\r\r\r4/4\r\rNA\r\r4\r\r\r\r5/5\r\rNA\r\r5\r\r\r\r6/6\r\rV\r\r6\r\r\r\r\r\nSo we now have several options:\nJoin between the two tables, save the clean table as a new xlsx and upload it to the University’s exam system.\rJoin between the two tables, clip the column with the organized grades and paste it into the university’s sorted excel file.\r\r\rOption 1 - Merge and write to a new excel file\rSo the first option will be to merge the two tables into the clean one and save that as a new excel file using the {xlsx} package:\njoined_tables \u0026lt;- messy %\u0026gt;% right_join(clean)\rxlsx::write.xlsx(joined_tables, \u0026quot;010210078-29012020C.xlsx\u0026quot;, showNA = FALSE)\rBelow is a screen shot of our new table:\nHowever, going with this approach I encountered that the new .xlsx file is saved with a new column of id numbers that we see in the screenshot. We can just delete that column and have our file all ready to go.\n\rOption 2 - Clip the sorted column into the excel file\rThis time around I’ll write a function for what we’ll be doing: I want to join the tables but this time around I want to clip the column I need and then manually paste it in the original template excel file:\nclip_grades \u0026lt;- function(messy, clean){\rmessy %\u0026gt;% right_join(clean) %\u0026gt;% pull(grade) %\u0026gt;% clipr::write_clip()\r}\rclip_grades(messy, clean)\rwhich gives us the following:\nThat’s it!\nWell, more or less. We need to delete the ‘NA’ that are copied from the function. Unfortunately I wasn’t able to delete them from within R, so I manually delete them.\nAs to which option is better, I think the first option is more efficient as we only need to delete the id column. However, using the {xlsx} package is dependent on {rJava}and having java installed on the computer from what I encountered. Option two can be a little messy and possibly yield mistakes if we copy and paste the new grades and then manually delete the NA - your call.\nSo what did I learn here?\r\rHow to read and write an excel file.\rUsing the write_clip function which is amazingly easy.\rHow to make updating exams easier 💪\r\r\n\r\r\rFor confidentiality and other reasons I only left columns with information that can’t be linked to students (I also changed the grades altogether for this demonstration).↩\n\r\r\r","date":1581724800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1583528114,"objectID":"5b9673a3312e79a1eaa0f953d5f22fd1","permalink":"/2020/02/15/update-exam-grades-easy-with-r/","publishdate":"2020-02-15T00:00:00Z","relpermalink":"/2020/02/15/update-exam-grades-easy-with-r/","section":"post","summary":"In this post I discuss my use of the xlsx and clipr packages for optimizing how I updated students exams","tags":[],"title":"Making updating exam grades easy with R","type":"post"},{"authors":[],"categories":["R"],"content":"\r\rFigure 1: Eliud Kipchoge breaks the two-hour marathon barrier. Photo from the ‘New York Times’. Leonhard Foeger/Reuters \r\rTable of Contents\r\rBackground\rRetrieving data from wikipedia\rWarngling the Data\rPlot\r\rggimage\rPlot Aesthetics\rFinal annotation\r\rAppendix\r\r\rBackground\rOn saturday October 12, 2019, Eliud Kipchoge broke (unofficially) the two-hour marathon barrier 🏆\nI saw Neil Saunders’ Twitter post visualizing the new record and wanted to try and reproduce it with runners instead of points. In this post I’ll walk through how I obtained the data from a Wikipedia page with {rvest}, wrangled and tidied it and eventually plotted it using {ggimage}.\nWhen I initially created the plot I mistakenly took the Marathon year rankings from the Wikipedia webpage. That page showcases The yearly rankings and not the world records in general. In addition, I also changed the method of obtaining the data from first creating the plot to now. When I first did it I copied and pasted the table from Wikipedia into a .csv file and worked with that. For that specific time point, where my experience with R was extremly novice, I think it was adequate. This time around I gave scraping Wikipedia’s webpage a try which also renders a reproducible example.\nLet’s start with loading the packages we’ll need:\nlibrary(tidyverse)\rlibrary(rvest)\rlibrary(janitor)\rlibrary(lubridate)\rlibrary(ggimage)\rlibrary(hrbrthemes)\rWe’ll use {tidyverse} for tidy manipulation and plotting, {janitor} for cleaning the column names, {lubridate} for working with dates, {ggimage} for a plot with images and {hrbrthemes} for a nice quick aesthetic theme.\n\rRetrieving data from wikipedia\rIn order to view the new record in comparison to other world records, We’ll turn to Wikipedia and see what we can find there.\n\rFigure 2: Wikipedia page of marathon world records\r\rHere we can see that the webpage contains information about marathon records, where in the screenshot we see the men section. We only want the table with men’s records, so let’s get that:\n#The Wikipage we\u0026#39;ll need\rwiki_url \u0026lt;- \u0026quot;https://en.wikipedia.org/wiki/Marathon_world_record_progression\u0026quot;\rrunners_wiki \u0026lt;- wiki_url %\u0026gt;% read_html() %\u0026gt;% html_nodes(xpath=\u0026#39;//*[@id=\u0026quot;mw-content-text\u0026quot;]/div/table[1]\u0026#39;) %\u0026gt;% html_table(fill = TRUE) %\u0026gt;% as.data.frame()\rUsing the {rvest} package we are able to scrape the Wikipedia page for the table we wanted. Frankly, this is the first time I used rvest, but I found a good example from Kasia Kulma’s blog post exploring London crime with R heat maps. I used the SelctorGadget which identified the page’s content as “mw-content-text”. Using that id we looked for the tables (/div/table), specifically the first table [1] of men world records we saw earlier in figure 2. Once we have the table we turn it into a dataframe for us to use.\nAlternatively, you can also use the following method to extract a table by extracting all tables from the Wikipedia page and choosing the first one:\nrunners_wiki_alternative \u0026lt;- wiki_url %\u0026gt;% read_html() %\u0026gt;%\rhtml_table(fill = TRUE) %\u0026gt;%\r.[[1]]\rThis option extracts all table from the html page using html_table(). Using this on the whole page parses the html tables into data frames nesting within a list object. Like before, {rvest} makes it easy for us and if the tables have inconsistent number of values it requires (or demands?) us to fill them. Once we have the tables in a list object we can extract the one we need using .[[1]]. The . acts as a place holder for the previous object passed, in this case the list of tables we scraped. The [[1]] following that calls for the first object within the list, but in the form of its core class, in this case a class(runners_wiki_alternative). If we’d use one square bracket [1] it would return an object with the original class from which it was drawn, in this case a list which is not good for us here since we anyway want it as a dataframe.\n\rWarngling the Data\rLet’s look at our table to see what we have and what we’ll need to do:\nhead(runners_wiki, n = 3)\r## Time Name Nationality Date\r## 1 2:55:18.4 Johnny Hayes United States July 24, 1908\r## 2 2:52:45.4 Robert Fowler United States January 1, 1909\r## 3 2:46:52.8 James Clark United States February 12, 1909\r## Event.Place Source\r## 1 London, United Kingdom IAAF[53]\r## 2 Yonkers,[nb 5]United States IAAF[53]\r## 3 New York City, United States IAAF[53]\r## Notes\r## 1 Time was officially recorded as 2:55:18 2/5.[54]Italian Dorando Pietri finished in 2:54:46.4, but was disqualified for receiving assistance from race officials near the finish.[55] Note.[56]\r## 2 Note.[56]\r## 3 Note.[56]\rA little messey but that’s OK. What we’ll need to visualize Eliud Kipchoge’s record is the Name, Time and Date of all runners. We’ll start with cleaning our data:\nrunners_clean \u0026lt;- runners_wiki %\u0026gt;% clean_names() %\u0026gt;% select(1,2,4)\rstr(runners_clean)\r## \u0026#39;data.frame\u0026#39;: 50 obs. of 3 variables:\r## $ time: chr \u0026quot;2:55:18.4\u0026quot; \u0026quot;2:52:45.4\u0026quot; \u0026quot;2:46:52.8\u0026quot; \u0026quot;2:46:04.6\u0026quot; ...\r## $ name: chr \u0026quot;Johnny Hayes\u0026quot; \u0026quot;Robert Fowler\u0026quot; \u0026quot;James Clark\u0026quot; \u0026quot;Albert Raines\u0026quot; ...\r## $ date: chr \u0026quot;July 24, 1908\u0026quot; \u0026quot;January 1, 1909\u0026quot; \u0026quot;February 12, 1909\u0026quot; \u0026quot;May 8, 1909\u0026quot; ...\rThe clean_names function cleans the column names making them easier to use. I then picked the columns we’ll need using select. Lastly, we want to look at the variables structure to see if we they need any manipulations. Yes, it seems both the time and date are not recognized appropriately (In this case they’re characters) - let’s fix that:\nrunners_mutate \u0026lt;- runners_clean %\u0026gt;% add_row(time = \u0026quot;1:59:40\u0026quot;, name = \u0026quot;Eliud Kipchoge\u0026quot;, date = \u0026quot;November 12, 2019\u0026quot;) %\u0026gt;% mutate(run_period_raw = hms(time),\rrun_duration = as.numeric(run_period_raw, \u0026quot;minutes\u0026quot;),\rrun_year = year(mdy(date))) %\u0026gt;% select(c(-date,-time))\r## Warning: 1 failed to parse.\rLet’s see what we did here. First I add Eliud Kipchoge’s new unofficial record as an observation into our dataframe. I then turned to the {lubridate} package where I used the hms function to mutate the time variable we had into a new variable called ‘r_period_raw’. Although this cleans the variable, hms transforms it into a period object which I found a little difficult to use when we want to plot. What we need is to turn it into a numeric class which we did in our new variable ‘run_duration’. This will help us in plotting but I retained the period class variable as it makes it easier to read in this case.\nI then turned the date column into a Month-Day-Year variable using the mdy function, which eventually I only extracted the year using year. Lastly I discarded the old columns we don’t need anymore. We also recieved a warning sign that one observation didn’t parse. This was because the value in the cell didn’t match the pattern of the hms fuction. The original pattern looked like this: May 26, 1909[nb 6]. All we want is the specific year which we’ll probably anyway filter later so it’s no big deal, but let’s go ahead and manually add it if we decide to use it later:\nrunners_mutate[5,4] \u0026lt;- 1909\rThis brings us the following:\nggplot(runners_mutate,aes(x = run_year, y = run_duration))+\rgeom_point()\rGreat, that’s a good start. Now we want to make it a little less crowded so we can easily insert an image of runners instead of points and not have it cluttered. In order to do that we’ll look at each several years and lastly at 2019, the current record. First, let’s look at the years we have:\nrunners_mutate %\u0026gt;% pull(run_year)\r## [1] 1908 1909 1909 1909 1909 1909 1913 1913 1914 1920 1925 1929 1935 1935 1935\r## [16] 1935 1947 1952 1953 1953 1954 1956 1958 1960 1963 1963 1963 1964 1964 1965\r## [31] 1967 1969 1970 1974 1978 1980 1981 1984 1985 1988 1998 1999 2002 2003 2007\r## [46] 2008 2011 2013 2014 2018 2019\rUsing the pull function we were able to extract the column we wanted, much similar to using the runners_mutate$column_name approach. ‘Unfortunately’, we can’t filter exactly by round intervals (for example every exact 10 years) so we’ll create a vector with specific years to filter by. Although it might sound trivial, make sure you’re assigning years that are observed in your data set, otherwise it’ll filter only by the years you do have and not those you don’t.\nyear_sub \u0026lt;- c(1908, 1920, 1929, 1947, seq(1960,1980,10), 1999, 2011, 2019)\rHere we created a vector with values for every 15+- years. Now we can filter our new dataframe according to the years we want:\nrunners_mutate \u0026lt;- runners_mutate %\u0026gt;% filter(run_year %in% year_sub)\rUsing the filter function with %in% we discard anything from the run_year column that’s not in the year_sub vector. I find %in% facsinating and extremely helpful when you want to look/filter several parameters. Basically, you can read it as “Keep all rows in ‘run_year’ that match values in ‘year_sub’”.\n\rPlot\rggimage\rIn order for us to plot a runner icon instead of points we need to load the images into our data frame as values for each observation. To do that we use the {ggimage} package which we’ll also use for the plot.\nrunners_mutate \u0026lt;- runners_mutate %\u0026gt;% mutate(run_image = \u0026quot;run.png\u0026quot;)\rAnd now let’s look at our new plot:\ng \u0026lt;- ggplot(runners_mutate, aes(x = run_year, y = run_duration))+\rgeom_image(aes(image = run_image), size = 0.05)+\rtheme_ipsum_rc()\rg\rNot bad. I like the icons although the whole graph might be a bit misleading if readers perceive that these are the only records there are. However, this is a tutorial and we’ll also add that note into our plot momentarily. You can adjust the size and other parameters of the images we plot, here for example I chose to adjust the size from its default. I also added theme_ipsum_rc from the {hrbrthemes} package for a quick aesthetic theme I like.\n\rPlot Aesthetics\rSo the plot so far looks nice, but we want it to be aesthetic and also to easily understand the progress of records across years. In order to do that, let’s turn to adjust both the y and x axis, and following that add some information to understand what we’re looking at:\ng1 \u0026lt;- g +\rscale_x_continuous(name = \u0026quot;Year\u0026quot;,\rlimits = c(1900,2025),\rbreaks = seq(1900,2020,10),\rlabels = c(\u0026quot;1900\u0026quot;, paste0(\u0026quot;\u0026#39;\u0026quot;, seq(10,90,10)),\u0026quot;2000\u0026quot;,\r\u0026quot;\u0026#39;10\u0026quot;,\u0026quot;\u0026#39;19\u0026quot;))\rHere we added some nice x labels in a format that’s both concise and informative. I remember taking this from Liam Bailey’s #Tidytuesday plot a while back when i first made this visualiztion. What we did was teak the scale_x_continuous by assigning a name to the axis, expanding its limits, added specific breaks and then a label for each break using paste0. Note that you must have the same number of labels and breaks for the plot to render so it’s important to have the sequences identical in length; otherwise it’ll return an error. With the paste0 we can add any value or observation and then ‘stick’ to it whatever else we want. Using that we are able to create years in the format of ’10 and so on. It is also possible to use the {glue} package which I heard is very intuitive, maybe next post I’ll give that a try.\nNext, let’s change our y duration axis:\ng2 \u0026lt;- g1 + scale_y_time(name = \u0026quot;Time (hours)\u0026quot;,\rlimits = c(100,180),\rbreaks = seq(100,180,10),\rlabels = c(\u0026quot;1:40\u0026quot;,\u0026quot;1:50\u0026quot;, \u0026quot;2:00\u0026quot;, \u0026quot;2:10\u0026quot;,\u0026quot;2:20\u0026quot;,\u0026quot;2:30\u0026quot;,\u0026quot;2:40\u0026quot;, \u0026quot;2:50\u0026quot;, \u0026quot;3:00\u0026quot;))\rIf you recall, we previously mutated the column we read from Wikipedia into a period class and a duration of minutes. using the scale_*_time (either x or y instead of *) we can work with an hms object. What we did is add a name, expand a little the limits, add breaks and labels same as before. This time around we used our breaks as minutes, so every 60 minutes represents an hour. I initially used hours as the numeric value, but then it makes it harder to break every 10 minutes (that’ll mean breaks every 0.166…). For the labels I was having some problems automating it so I comprimised on manually inputting it; I guess sometimes you just have to choose your battles between automating and manualy inserting.\nLet’s finish up by adding a title, subtitle and integrating last aesthetics to our plot.\ng3 \u0026lt;- g2 +\rlabs(title = \u0026quot;How does Eliud Kipchoge marathon score compare to previous yearly records?\u0026quot;,\rsubtitle = \u0026quot;Points are world records for every 10-15 years. \\nEliud Kipchoge is the first to break the two-hour barrier (unofficially), Great job!\u0026quot;)+\rtheme(\rpanel.grid.minor = element_blank(),\rpanel.grid.major = element_line(colour = \u0026quot;gray75\u0026quot;, size = 0.1, linetype = \u0026quot;dashed\u0026quot;),\rplot.title = element_text(size = 14),\rplot.subtitle = element_text(size = 10)\r)\rAfter adding some labs I tweaked a bit the gridlines using panel.grid minor or major. You can play around with them to see which minimilize your plot in the perfect way. I chose to leave the major grid lines since I find it easier to read the values with them. Although we defined a theme earlier on we can still tweak it by adding another theme argument to the previous one as we just did.\n\rFinal annotation\rLastly, we want the new record to be evident and stand out in a first glance. Here I was somewhat debating between using a regular geom_point instead of the geom_image because then we could easily use a vertical line to highlight the 2:00 hour threshold. Since a line in this case will cut right through the icon, let’s use an arrow annotation instead.\ng4 \u0026lt;- g3 +\rgeom_curve(aes(x = 2018, y = 120, xend = 2015, yend = 113),\rcolour = \u0026quot;black\u0026quot;, size = 0.9, curvature = 0.5,\rarrow = arrow(length = unit(2,\u0026quot;mm\u0026quot;), type = \u0026quot;closed\u0026quot;))+\rannotate(\u0026quot;text\u0026quot;, x=2010, y= 105, label = \u0026quot;Eliud Kipchoge\\n12.10.2019\\n1:59:40\u0026quot;,\rcolor = \u0026quot;black\u0026quot;, size = 3, hjust = 0)\rg4\rAnd voila!\nIn our final touches we added both an arrow and text to explain what we’re seeing. I decided to go with a geom_curve arrow where we can set the start and end of the arrow along with the kind of curve we want. We then set the curve to be arrow and adjust its length. You can also use a closed head arrow, for more on that read on ?arrow as part of the geom_curve or geom_segment you can use here.\nThat’s it, seems like were good to go. Great job for Elihud Kipchoge 👏\n\n\r\rAppendix\r\rWhen I initially created this visulization I was just starting with R. I first created 11 slots, added 1921, the sequence of 1930-2010 and then a 2019 (reminder: When I first created this viz I took a different dataset altogether). Little did I know how to properly use the c() function that we used in the current post.\r\ryear.sub \u0026lt;- vector (\u0026quot;double\u0026quot;, 11)\ryear.sub[1] \u0026lt;- 1921\ryear.sub[2:10] \u0026lt;- seq(1930,2010,10)\ryear.sub[11] \u0026lt;- 2019\r\rBack to top\r\r\r","date":1581033600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1581080421,"objectID":"61554887203386d7c8bd4596bbb5b349","permalink":"/2020/02/07/eliud-kichoge/","publishdate":"2020-02-07T00:00:00Z","relpermalink":"/2020/02/07/eliud-kichoge/","section":"post","summary":"In this post I plot Eliud Kichoge new marathon record using rvest to get data from wikipedia and ggimage for plotting images as points","tags":["ggimage","rvest"],"title":"Visualizing Eliud Kichoge's new marathon record","type":"post"},{"authors":[],"categories":["R"],"content":"\r\r\r\r\r\r\rUpdate from March 21, 2020\rI’ve been wanting to return to this post and make this map more interactive. As a matter of fact it was easier than I thought, I just never got around to doing it. I won’t be going through the code for the leaflet map below but will leave it for whoever would like to review it:\nlibrary(leaflet)\rlibrary(magrittr)\rreadr::read_csv(\u0026quot;shelters.csv\u0026quot;) %\u0026gt;% leaflet() %\u0026gt;% addTiles() %\u0026gt;% setView(34.7913, 31.25181,zoom = 13) %\u0026gt;% addCircles(radius = 4, color = \u0026quot;red\u0026quot;, fill = TRUE)\r\r{\"x\":{\"options\":{\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}}},\"calls\":[{\"method\":\"addTiles\",\"args\":[\"//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",null,null,{\"minZoom\":0,\"maxZoom\":18,\"tileSize\":256,\"subdomains\":\"abc\",\"errorTileUrl\":\"\",\"tms\":false,\"noWrap\":false,\"zoomOffset\":0,\"zoomReverse\":false,\"opacity\":1,\"zIndex\":1,\"detectRetina\":false,\"attribution\":\"\u0026copy; OpenStreetMap contributors, CC-BY-SA\"}]},{\"method\":\"addCircles\",\"args\":[[31.259018768,31.2597950910001,31.2592493760001,31.2573049280001,31.2574797520001,31.258424086,31.254246294,31.255173057,31.2556456460001,31.253666206,31.2537330280001,31.2569812850001,31.2570752350001,31.257608025,31.2575462630001,31.2700855640001,31.2702905,31.2695012190001,31.2658482960001,31.259725431,31.2646111440001,31.266921333,31.2604320470001,31.2596058720001,31.262762868,31.263789048,31.261942934,31.2638102080001,31.2632644710001,31.263504445,31.262432614,31.2708580180001,31.2711996570001,31.270725645,31.2712747300001,31.2718630300001,31.2720855330001,31.2726126790001,31.272427384,31.2704051920001,31.266736774,31.2628119170001,31.2455927190001,31.248994151,31.250188747,31.2459192310001,31.24676858,31.2479923820001,31.2478412890001,31.249363784,31.250175772,31.248725547,31.248610904,31.251846362,31.2518736100001,31.250946067,31.253505949,31.257884104,31.2540270010001,31.2559118880001,31.2710156910001,31.271205497,31.270356722,31.269982842,31.2698227120001,31.269304209,31.269990116,31.2687801060001,31.2682527530001,31.2683451450001,31.270695158,31.27323147,31.2733343200001,31.2737922810001,31.2728741080001,31.274249592,31.2746572610001,31.272394175,31.2739432400001,31.2744760080001,31.2717045570001,31.2729638220001,31.2757156430001,31.2741278410001,31.2746324350001,31.274596902,31.271494137,31.2718457610001,31.275141078,31.275589424,31.2759297440001,31.2649303200001,31.270103943,31.2659409890001,31.2669887380001,31.2697833300001,31.2704315440001,31.266575474,31.266131746,31.221500807,31.224164194,31.223587228,31.2258336940001,31.222024801,31.2197570490001,31.221235918,31.224912993,31.224000586,31.2261810250001,31.223021734,31.2238066,31.2209769780001,31.222977471,31.2321786260001,31.2324369340001,31.2431229220001,31.235916617,31.238806793,31.237065128,31.248259068,31.251491909,31.2504392380001,31.2504933070001,31.2518083160001,31.246153377,31.250630739,31.25563615,31.256696517,31.254957205,31.257290099,31.25460144,31.256567933,31.255031301,31.2575173870001,31.2579245330001,31.2579056490001,31.2226565670001,31.224564345,31.2426843960001,31.240248009,31.2399610090001,31.267945217,31.2638298580001,31.270236595,31.269875347,31.265144816,31.2690648330001,31.2681699770001,31.269377084,31.265713315,31.270953035,31.2722040720001,31.2645033750001,31.271228369,31.2715811,31.256697924,31.257101161,31.269666226,31.275281239,31.274241079,31.269109099,31.272405753,31.2598086400001,31.250707328,31.251678113,31.2525321090001,31.2486613240001,31.2554510690001,31.2490194850001,31.2670087990001,31.2682888350001,31.269309503,31.250801417,31.268097267,31.2679672850001,31.267170004,31.261017135,31.2604871560001,31.261171405,31.260286697,31.260856463,31.258957008,31.2669088850001,31.264312395,31.2644250700001,31.262675503,31.262628384,31.266354108,31.2378694280001,31.237196182,31.2522976180001,31.2551276230001,31.2555366730001,31.271009238,31.2697859260001,31.248898803,31.250194783,31.250113594,31.248703956,31.2482595930001,31.247643195,31.252913957,31.2562439010001,31.250285107,31.2561600820001,31.2510416860001,31.249713179,31.258150351,31.2590159170001,31.2581197600001,31.25558649,31.2571552970001,31.254918092,31.2545320300001,31.2465726200001,31.2520725430001,31.261599754,31.2721663470001,31.270971611,31.2616581070001,31.264973377,31.2658491130001,31.2688886780001,31.2683040970001,31.2707125310001,31.271428288,31.254769068,31.257070663,31.2465921090001,31.2692059390001,31.2443915640001,31.2314304170001,31.269208157,31.269363072,31.270308577,31.2595743270001,31.2700607460001,31.2564875580001,31.2479156200001,31.2481547410001,31.254812955,31.266566502,31.2504635080001,31.2541823770001,31.2683791260001,31.271307544,31.2482951640001,31.2737507580001,31.272590789,31.2570404000001,31.252699315,31.2517972700001,31.2663416,31.2709878490001,31.2660293330001,31.25408293,31.2701366480001,31.2402113960001,31.2646567780001,31.2463304390001,31.2347788370001,31.252428283],[34.808214546,34.8078915740001,34.809368438,34.8093634950001,34.810975436,34.810334568,34.805622382,34.8026935250001,34.804473768,34.8095251010001,34.8075520780001,34.808555186,34.7651206140001,34.76364862,34.7628454490001,34.778674504,34.7777073990001,34.7762277100001,34.770138844,34.7869285290001,34.795184944,34.7997725760001,34.7940810010001,34.7916208840001,34.7906790590001,34.79068958,34.7927366010001,34.79231459,34.7927492380001,34.792743929,34.7905235110001,34.7883433920001,34.7867639080001,34.785602972,34.7852056130001,34.787070295,34.787588817,34.7939116200001,34.7924905290001,34.7941080740001,34.8014500780001,34.792161772,34.7956425140001,34.7970971840001,34.7970376860001,34.7936621440001,34.7914949660001,34.784890746,34.787583614,34.7873553950001,34.7857147330001,34.779422326,34.7796193240001,34.7841264850001,34.7828629210001,34.7779282610001,34.782604796,34.7832538050001,34.7900850610001,34.7963698560001,34.806238138,34.8089210210001,34.809585251,34.8086036290001,34.809357278,34.8091260510001,34.8067740120001,34.8089092710001,34.8086805990001,34.8079129270001,34.804323229,34.800439962,34.8088667390001,34.8085067230001,34.809244467,34.808135475,34.8077908650001,34.8096215740001,34.8069308010001,34.806502575,34.8037255140001,34.802776814,34.802732577,34.8024465140001,34.8025668970001,34.804125362,34.802364975,34.8055181280001,34.8074389120001,34.8070149960001,34.8064910510001,34.7604294980001,34.7639117040001,34.765621094,34.7664207510001,34.7608955090001,34.7630732060001,34.7598450790001,34.7611068100001,34.775540274,34.7789006310001,34.7774103090001,34.778600274,34.7726666250001,34.773724196,34.7718155210001,34.775669044,34.780235401,34.780269586,34.7763314490001,34.775308716,34.7743583120001,34.7736159990001,34.7923748970001,34.78033953,34.779738781,34.784380764,34.7847258240001,34.7817552400001,34.792498504,34.7868126540001,34.789983894,34.789128825,34.787953332,34.7942136410001,34.7945532960001,34.7903546790001,34.7959888820001,34.7941725480001,34.795403445,34.7891443610001,34.793907173,34.7965042000001,34.7892947980001,34.781547866,34.783656121,34.7751580730001,34.780917947,34.781822312,34.781617833,34.783344335,34.7623511370001,34.762642929,34.771785949,34.7709577200001,34.7636153930001,34.7619093160001,34.7644633370001,34.764872847,34.7577812160001,34.770979358,34.765673103,34.7643799360001,34.767547478,34.769529817,34.773305672,34.773415368,34.805293723,34.805267585,34.800891017,34.808306987,34.806721075,34.8088518340001,34.8019847370001,34.8065743970001,34.810013871,34.8081264090001,34.7780347280001,34.782620235,34.7707858410001,34.7723190740001,34.774894422,34.77918176,34.7948698500001,34.7970907800001,34.795007293,34.79702511,34.7965872190001,34.795338615,34.7935443280001,34.7929193080001,34.7929353970001,34.7939598030001,34.795247798,34.797073217,34.7944644400001,34.7974265890001,34.792997642,34.785492021,34.7889980750001,34.804945893,34.8100962180001,34.808716111,34.783396279,34.7850399330001,34.795998975,34.805139436,34.8028419560001,34.8061534390001,34.804344707,34.807264053,34.81146289,34.806185188,34.806567597,34.81037658,34.80369548,34.8085987040001,34.811233825,34.809843013,34.8094435680001,34.8080172910001,34.810334235,34.8070907060001,34.8035195030001,34.8086055260001,34.802861137,34.7937478430001,34.7956186760001,34.793586141,34.7919188430001,34.79992937,34.801187988,34.8012474810001,34.792345267,34.7969623870001,34.794766757,34.8086733960001,34.80687017,34.776587685,34.79294107,34.791070099,34.7935582580001,34.7954634880001,34.7948531970001,34.7868227160001,34.7857320460001,34.795653003,34.791395838,34.7796560830001,34.781008178,34.77898084,34.794873022,34.780569927,34.8023777060001,34.7968104340001,34.7835412000001,34.7892121180001,34.807038339,34.8080192800001,34.8085495820001,34.779316936,34.8025542940001,34.7698468990001,34.8072728060001,34.8008629990001,34.8116456560001,34.7842904080001,34.7950379800001,34.7961240610001,34.8083349930001,34.7825503890001,34.808149154],4,null,null,{\"interactive\":true,\"className\":\"\",\"stroke\":true,\"color\":\"red\",\"weight\":5,\"opacity\":0.5,\"fill\":true,\"fillColor\":\"red\",\"fillOpacity\":0.2},null,null,null,{\"interactive\":false,\"permanent\":false,\"direction\":\"auto\",\"opacity\":1,\"offset\":[0,0],\"textsize\":\"10px\",\"textOnly\":false,\"className\":\"\",\"sticky\":true},null,null]}],\"setView\":[[31.25181,34.7913],13,[]],\"limits\":{\"lat\":[31.2197570490001,31.2759297440001],\"lng\":[34.7577812160001,34.8116456560001]}},\"evals\":[],\"jsHooks\":[]}\r\rOriginal post\rI’ve been wanting to learn how to use maps in R for a while before creating the map in this post. Seeing dataframes with longitude and latitude coordinates on various occasions on #Tidytuesday encouraged me to do so.\nA day before this visualizaiton, I discovered our municupality’s open access data website. In this website you can find various datasets like street light coordinates, bomb shelters spread out in the city and more. A day after discovering it Israel, the country I live in, was fired missiles at. I decided to take the opportunity and map some of the shelters around my house. You know, just in case.\nLet’s begin with the packages (📦) we’ll need:\n#for data manipulation\rlibrary(tidyverse)\r#for a nice map\rlibrary(ggmap)\r#for reading and working with .geojson file\rlibrary(geojsonio)\rlibrary(sp)\r#for integrating a nice font\rlibrary(extrafont)\rLoading and tidying the data\rI initially tried using the .csv file they have on their webiste but I was having too much trouble with the Hebrew so I decided to try and work with the geojsonio package. I had no idea how to work with a .geojson file or frankly how to work with maps in general. To my save, i found this incredible blog by John Johnson to help me transform a ‘geomjson’ file to a dataframe you can work with.\nLet’s begin:\n#read the .geojson file\rmy_geojson \u0026lt;- \u0026quot;shelters.geojson\u0026quot;\r#convert the .geojson file to an sp object\rdata_json \u0026lt;- geojson_read(my_geojson, what = \u0026quot;sp\u0026quot;)\r#now we can convert it to a nice data frame\rshelters \u0026lt;- as.data.frame(data_json)\r#last tidying of the column names\rnames(shelters)[6:7] \u0026lt;- c(\u0026quot;long\u0026quot;, \u0026quot;lat\u0026quot;)\rWhat we did was load the geojson file, read it as an ‘sp’ object and then turn it into to a dataframe. I changed the names so that it’ll be easier to read the columns. we could also use dplyr::rename but I liked the base R function Johnson used in his blog so I’ll stick with that.\nlet’s look at the top 3 observations of our new data frame:\n## long lat name X.U.05E7..U.05D5..U.05D3._.U.05E1.\r## 1 34.80821 31.25902 \u0026lt;U+05D2\u0026gt;/2 17\r## 2 34.80789 31.25980 \u0026lt;U+05D2\u0026gt;/1 17\r## 3 34.80937 31.25925 \u0026lt;U+05D2\u0026gt;/25 17\r## elc group_ F_.U.05E6..U.05D5..U.05D5..U.05EA.\r## 1 \u0026lt;U+05D9\u0026gt;\u0026lt;U+05E9\u0026gt; 0 ## 2 \u0026lt;U+05D9\u0026gt;\u0026lt;U+05E9\u0026gt; 0 ## 3 \u0026lt;U+05D9\u0026gt;\u0026lt;U+05E9\u0026gt; 0\rUgh, well the names weren’t read well into R. While this isn’t a big issue to resolve, I don’t find it necessary for the final piece. the names of the shelters are anyway in Hebrew and only represnt a letter and some sort of number (for e.g, A/23, only in Hebrew). Therefore we’ll leave it as is since what I’m interested in is the longitude and latitude coordinations and for that we don’t need the character column.\n\rRetrieving the map\rSo we have our data frame with long and lat points, let’s get our map. I want a map that can be readable in terms of streets and roads, therefore I’ll give the ggmap package a try1. Google requires you to register in order to recieve an API key to pull maps to plot. Unfortunately I won’t cover how to regiser in this blog post but I’m sure you can find plenty of tutorials addressing it online.\nLet’s get Be’er-Sheva’s map:\nb7_map \u0026lt;- get_map(location = c(34.7913 , 31.25181), zoom = 13, scale = 2, maptype = \u0026quot;roadmap\u0026quot;)\rWhat we did here was use the get_map function to pull the map according to the long and lat coordinates I gave it of Be’er-Sheva. You should first pass the longitude and then the latitude in the location argument. In addition you can change other features such as the zoom level, the maptype and more as we saw here (See ?get_map for more info).\n\rPlot\rNow that we have our data set ready and the map as an object we can go on to plot it. ggmap extends ggplot features so we can run the data frame smoothly into the ggmap function:\nggmap(b7_map)+\rgeom_point(shelters, mapping = aes(long,lat),\rcolor = \u0026quot;red\u0026quot;, size = 0.3, shape = 15)\rWhat we did was pass the b7_map as an object into the ggmap function and add a geom, in this case geom_point representing our shelter coordinates. However, this map doesn’t really help me in a time of need since it doesn’t show my address clearly.\nLet’s try zooming in so that we can see what we’re looking at:\n#retreiving a new map with a greater `zoom`\rb7_map_zoom \u0026lt;- get_map(location = c(34.7913 , 31.25181), zoom = 16, scale = 2, maptype = \u0026quot;roadmap\u0026quot;)\rp \u0026lt;- ggmap(b7_map_zoom)+\rgeom_point(shelters, mapping = aes(long,lat), color = \u0026quot;red\u0026quot;,\rsize = 3, shape = 15)\rp\rMuch nicer and clearer. Using the zoom option in get_map enables to center more on where I want. Great, this shows me some bomb shetlers I have around me in a time of need. Let’s add some fine tuning for our theme:\np+ #for the title, caption and removing the X and Y axis\rlabs (title = \u0026quot;Neighborhood B, Beer-Sheva, Israel, bomb shelters\u0026quot;,\rx = NULL, y = NULL,\rcaption = \u0026quot;data: www.beer-sheva.muni.il | @Amit_Levinson\u0026quot;)+\rtheme_minimal()+\rtheme(text = element_text(family = \u0026quot;Microsoft Tai Le\u0026quot;),\r#Changing the position of the title\rplot.title = element_text(hjust = 0.5, size = 20, face = \u0026quot;bold\u0026quot;),\raxis.text = element_blank(),\rplot.caption = element_text(size = 9, face = \u0026quot;italic\u0026quot;, hjust = 0),\rpanel.border = element_rect(color = \u0026quot;black\u0026quot;, size=2, fill = NA)\r)\rPerfect, I can now save the plot and distribute it if someone needs it.\nggsave(\u0026quot;shelters_b_eng.png\u0026quot;, width = 8, height = 8)\r\r1. I\u0026#39;ve been wanting to learn to plot maps in #rstats\n2. Yesterday I encountered open data our municipality publishes\n3. Today missiles are fired towards Israel in response to assassination of a top terrorist.\n1+2+3: Plotting bomb shelter locations near where I live#ggmap pic.twitter.com/4Irz0ZKuZr\n\u0026mdash; Amit Levinson (@Amit_Levinson) November 12, 2019  \r\r\r\rFor a first map I decided to go with a static one, but an interactive one can defenitely be a 2.0 version of this blog (as you saw with the March 21st update. Hopefully we won’t need it.↩\n\r\r\r","date":1578960000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1579118154,"objectID":"ec1b7e0fefbca8377eccf21297d09eec","permalink":"/2020/01/14/bomb-shelters/","publishdate":"2020-01-14T00:00:00Z","relpermalink":"/2020/01/14/bomb-shelters/","section":"post","summary":"While rockets were fired towards Israel I decided to take the opportunity and plot  bomb shelters in Beer-Sheva.","tags":["ggmap"],"title":"Mapping bomb shelters in Be'er-Sheva, IL","type":"post"},{"authors":["Amit Levinson"],"categories":null,"content":" Click the Slides button above to demo Academic\u0026rsquo;s Markdown slides feature.   Supplementary notes can be added here, including code and math.\n","date":1554595200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1554595200,"objectID":"557dc08fd4b672a0c08e0a8cf0c9ff7d","permalink":"/publication/preprint/","publishdate":"2017-01-01T00:00:00Z","relpermalink":"/publication/preprint/","section":"publication","summary":"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum.","tags":["Source Themes"],"title":"An example preprint / working paper","type":"publication"},{"authors":[],"categories":[],"content":"Create slides in Markdown with Academic Academic | Documentation\n Features  Efficiently write slides in Markdown 3-in-1: Create, Present, and Publish your slides Supports speaker notes Mobile friendly slides   Controls  Next: Right Arrow or Space Previous: Left Arrow Start: Home Finish: End Overview: Esc Speaker notes: S Fullscreen: F Zoom: Alt + Click PDF Export: E   Code Highlighting Inline code: variable\nCode block:\nporridge = \u0026quot;blueberry\u0026quot; if porridge == \u0026quot;blueberry\u0026quot;: print(\u0026quot;Eating...\u0026quot;)   Math In-line math: $x + y = z$\nBlock math:\n$$ f\\left( x \\right) = ;\\frac{{2\\left( {x + 4} \\right)\\left( {x - 4} \\right)}}{{\\left( {x + 4} \\right)\\left( {x + 1} \\right)}} $$\n Fragments Make content appear incrementally\n{{% fragment %}} One {{% /fragment %}} {{% fragment %}} **Two** {{% /fragment %}} {{% fragment %}} Three {{% /fragment %}}  Press Space to play!\nOne  Two  Three \n A fragment can accept two optional parameters:\n class: use a custom style (requires definition in custom CSS) weight: sets the order in which a fragment appears   Speaker Notes Add speaker notes to your presentation\n{{% speaker_note %}} - Only the speaker can read these notes - Press `S` key to view {{% /speaker_note %}}  Press the S key to view the speaker notes!\n Only the speaker can read these notes Press S key to view    Themes  black: Black background, white text, blue links (default) white: White background, black text, blue links league: Gray background, white text, blue links beige: Beige background, dark text, brown links sky: Blue background, thin dark text, blue links    night: Black background, thick white text, orange links serif: Cappuccino background, gray text, brown links simple: White background, black text, blue links solarized: Cream-colored background, dark green text, blue links   Custom Slide Customize the slide style and background\n{{\u0026lt; slide background-image=\u0026quot;/img/boards.jpg\u0026quot; \u0026gt;}} {{\u0026lt; slide background-color=\u0026quot;#0000FF\u0026quot; \u0026gt;}} {{\u0026lt; slide class=\u0026quot;my-style\u0026quot; \u0026gt;}}   Custom CSS Example Let\u0026rsquo;s make headers navy colored.\nCreate assets/css/reveal_custom.css with:\n.reveal section h1, .reveal section h2, .reveal section h3 { color: navy; }   Questions? Ask\nDocumentation\n","date":1549324800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1549324800,"objectID":"0e6de1a61aa83269ff13324f3167c1a9","permalink":"/slides/example/","publishdate":"2019-02-05T00:00:00Z","relpermalink":"/slides/example/","section":"slides","summary":"An introduction to using Academic's Slides feature.","tags":[],"title":"Slides","type":"slides"},{"authors":null,"categories":null,"content":"\u0026hellip;\n","date":1530140400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1530140400,"objectID":"18d05a63a1c8d7ed973cc51838494e41","permalink":"/privacy/","publishdate":"2018-06-28T00:00:00+01:00","relpermalink":"/privacy/","section":"","summary":"\u0026hellip;","tags":null,"title":"","type":"page"},{"authors":null,"categories":null,"content":"\u0026hellip;\n","date":1530140400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1530140400,"objectID":"9b10c1f64082d3869fd4cb1f85809430","permalink":"/terms/","publishdate":"2018-06-28T00:00:00+01:00","relpermalink":"/terms/","section":"","summary":"\u0026hellip;","tags":null,"title":"","type":"page"},{"authors":null,"categories":null,"content":"","date":1461715200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1461715200,"objectID":"d1311ddf745551c9e117aa4bb7e28516","permalink":"/project/external-project/","publishdate":"2016-04-27T00:00:00Z","relpermalink":"/project/external-project/","section":"project","summary":"An example of linking directly to an external project website using `external_link`.","tags":["Demo"],"title":"External Project","type":"project"},{"authors":null,"categories":null,"content":"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum. Sed ac faucibus dolor, scelerisque sollicitudin nisi. Cras purus urna, suscipit quis sapien eu, pulvinar tempor diam. Quisque risus orci, mollis id ante sit amet, gravida egestas nisl. Sed ac tempus magna. Proin in dui enim. Donec condimentum, sem id dapibus fringilla, tellus enim condimentum arcu, nec volutpat est felis vel metus. Vestibulum sit amet erat at nulla eleifend gravida.\nNullam vel molestie justo. Curabitur vitae efficitur leo. In hac habitasse platea dictumst. Sed pulvinar mauris dui, eget varius purus congue ac. Nulla euismod, lorem vel elementum dapibus, nunc justo porta mi, sed tempus est est vel tellus. Nam et enim eleifend, laoreet sem sit amet, elementum sem. Morbi ut leo congue, maximus velit ut, finibus arcu. In et libero cursus, rutrum risus non, molestie leo. Nullam congue quam et volutpat malesuada. Sed risus tortor, pulvinar et dictum nec, sodales non mi. Phasellus lacinia commodo laoreet. Nam mollis, erat in feugiat consectetur, purus eros egestas tellus, in auctor urna odio at nibh. Mauris imperdiet nisi ac magna convallis, at rhoncus ligula cursus.\nCras aliquam rhoncus ipsum, in hendrerit nunc mattis vitae. Duis vitae efficitur metus, ac tempus leo. Cras nec fringilla lacus. Quisque sit amet risus at ipsum pharetra commodo. Sed aliquam mauris at consequat eleifend. Praesent porta, augue sed viverra bibendum, neque ante euismod ante, in vehicula justo lorem ac eros. Suspendisse augue libero, venenatis eget tincidunt ut, malesuada at lorem. Donec vitae bibendum arcu. Aenean maximus nulla non pretium iaculis. Quisque imperdiet, nulla in pulvinar aliquet, velit quam ultrices quam, sit amet fringilla leo sem vel nunc. Mauris in lacinia lacus.\nSuspendisse a tincidunt lacus. Curabitur at urna sagittis, dictum ante sit amet, euismod magna. Sed rutrum massa id tortor commodo, vitae elementum turpis tempus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean purus turpis, venenatis a ullamcorper nec, tincidunt et massa. Integer posuere quam rutrum arcu vehicula imperdiet. Mauris ullamcorper quam vitae purus congue, quis euismod magna eleifend. Vestibulum semper vel augue eget tincidunt. Fusce eget justo sodales, dapibus odio eu, ultrices lorem. Duis condimentum lorem id eros commodo, in facilisis mauris scelerisque. Morbi sed auctor leo. Nullam volutpat a lacus quis pharetra. Nulla congue rutrum magna a ornare.\nAliquam in turpis accumsan, malesuada nibh ut, hendrerit justo. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Quisque sed erat nec justo posuere suscipit. Donec ut efficitur arcu, in malesuada neque. Nunc dignissim nisl massa, id vulputate nunc pretium nec. Quisque eget urna in risus suscipit ultricies. Pellentesque odio odio, tincidunt in eleifend sed, posuere a diam. Nam gravida nisl convallis semper elementum. Morbi vitae felis faucibus, vulputate orci placerat, aliquet nisi. Aliquam erat volutpat. Maecenas sagittis pulvinar purus, sed porta quam laoreet at.\n","date":1461715200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1461715200,"objectID":"8f66d660a9a2edc2d08e68cc30f701f7","permalink":"/project/internal-project/","publishdate":"2016-04-27T00:00:00Z","relpermalink":"/project/internal-project/","section":"project","summary":"An example of using the in-built project page.","tags":["Deep Learning"],"title":"Internal Project","type":"project"},{"authors":["Amit Levinson","Robert Ford"],"categories":null,"content":" Click the Cite button above to demo the feature to enable visitors to import publication metadata into their reference management software.    Click the Slides button above to demo Academic\u0026rsquo;s Markdown slides feature.   Supplementary notes can be added here, including code and math.\n","date":1441065600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1441065600,"objectID":"966884cc0d8ac9e31fab966c4534e973","permalink":"/publication/journal-article/","publishdate":"2017-01-01T00:00:00Z","relpermalink":"/publication/journal-article/","section":"publication","summary":"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum.","tags":["Source Themes"],"title":"An example journal article","type":"publication"},{"authors":["Amit Levinson","Robert Ford"],"categories":null,"content":" Click the Cite button above to demo the feature to enable visitors to import publication metadata into their reference management software.    Click the Slides button above to demo Academic\u0026rsquo;s Markdown slides feature.   Supplementary notes can be added here, including code and math.\n","date":1372636800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1372636800,"objectID":"69425fb10d4db090cfbd46854715582c","permalink":"/publication/conference-paper/","publishdate":"2017-01-01T00:00:00Z","relpermalink":"/publication/conference-paper/","section":"publication","summary":"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum.","tags":["Source Themes"],"title":"An example conference paper","type":"publication"}]