<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Posts | Amit Levinson</title>
    <link>/post/</link>
      <atom:link href="/post/index.xml" rel="self" type="application/rss+xml" />
    <description>Posts</description>
    <generator>Source Themes Academic (https://sourcethemes.com/academic/)</generator><language>en-us</language><copyright>¬© Amit Levinson 2020</copyright><lastBuildDate>Mon, 09 Mar 2020 00:00:00 +0000</lastBuildDate>
    <image>
      <url>/images/icon_hudc5a425b3e555d4faa8838526864126b_16079_512x512_fill_lanczos_center_2.png</url>
      <title>Posts</title>
      <link>/post/</link>
    </image>
    
    <item>
      <title>Israeli elections on twitter</title>
      <link>/2020/03/09/israeli-elections-on-twitter/</link>
      <pubDate>Mon, 09 Mar 2020 00:00:00 +0000</pubDate>
      <guid>/2020/03/09/israeli-elections-on-twitter/</guid>
      <description>


&lt;p&gt;Israel just had its 3rd election in a row on March 2, 2020.
This is because our Knesset (Hebrew term for house of representatives) wasn‚Äôt able to form or hold a government after the previous elections. As I won‚Äôt get into the politics of why they didn‚Äôt succeed thus far (get it? politics üòâ), I do want to take the opportunity and analyze some tweets posted in the time before and after the elections.&lt;/p&gt;
&lt;div id=&#34;gathering-the-data&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Gathering the data &lt;i class=&#34;fab fa-twitter&#34;&gt;&lt;/i&gt;&lt;/h3&gt;
&lt;p&gt;Twitter‚Äôs API only always scraping for free 6-9 days back. therefore I scraped the data already on March 7, 2020 and saved it for later use. To gather the tweets we can use the &lt;code&gt;{rtweet}&lt;/code&gt; package which is amazingly easy to use (&lt;a href=&#34;https://rtweet.info/&#34;&gt;Check out its website&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;Let‚Äôs start with the packages we‚Äôll use:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(tidyverse)
library(rtweet)
library(hrbrthemes)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Next we‚Äôll gather the tweets we need:&lt;/p&gt;
&lt;p&gt;As I mentioned earlier I already scraped the data to save it but wrote it here in case you‚Äôre wondering how we gather them. I used only one term, which in hebrew is ‚Äúelections‚Äù, and gathered all tweets using that word.&lt;/p&gt;
&lt;p&gt;Before we begin, I will say this post doesn‚Äôt aim to be representative of the discussions that were held during the election period. As a matter of fact, nor does it aim to be representative of the twitter discussion. this is due for several reasons:&lt;br /&gt;
1. Twitter isn‚Äôt common in Israel at all. I‚Äôm not sure what‚Äôs the usage rate but it‚Äôs definitely not representative of the Israel population.&lt;br /&gt;
2. I searched for only one word - elections (in Hebrew) - which yielded some 16,000 tweets. This is definitely not a large enough dataset for a representation.&lt;/p&gt;
&lt;p&gt;With that said, the data gathered provides an opportunity to look at some Twitter data from the elections period.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;lets-begin&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Let‚Äôs begin&lt;/h3&gt;
&lt;p&gt;First, let‚Äôs see how the tweets distribute across the time span we searched for. we can create a quick time plot using the &lt;code&gt;ts_plot()&lt;/code&gt; from the &lt;code&gt;{rtweet}&lt;/code&gt; package:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;elections %&amp;gt;% 
  ts_plot(&amp;quot;2 hours&amp;quot;)+
  theme_ipsum_rc()+
  scale_x_datetime(date_breaks = &amp;quot;1 day&amp;quot;,date_labels = &amp;quot;%d %b&amp;quot;)+
    labs(x= NULL, y = NULL,
       title = &amp;quot;Frequency of tweets throughout the Israeli elections&amp;quot;,
       subtitle = &amp;quot;Tweets are counts aggregated using a two-hour interval.\nonly tweets with the word &amp;#39;elections&amp;#39; (in Hebrew) were gathered&amp;quot;)+
  geom_text(aes(x = as.POSIXct(&amp;quot;2020-03-02 22:10:00&amp;quot;), y = 425, label = &amp;quot;10 PM:\nClosing of\npolls&amp;quot;),
            hjust = 0, size = 3, family=&amp;quot;Courier New&amp;quot;)+
  geom_vline(xintercept = as.POSIXct(&amp;quot;2020-03-02 22:00&amp;quot;),linetype = &amp;quot;dashed&amp;quot;, size = 1)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/elections-twitter/2020-03-09-israeli-elections-on-twitter_files/figure-html/unnamed-chunk-3-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Intersting, we see the number of tweets during the closing time is equivalent to that of XXXX.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;users-with-most-tweets&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;USers with most tweets&lt;/h3&gt;
&lt;p&gt;Next, let‚Äôs look at who tweeted the most:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;elections %&amp;gt;% 
  count(screen_name, sort = T) %&amp;gt;% 
  slice(1:15) %&amp;gt;% 
  mutate(screen_name = reorder(screen_name,n)) %&amp;gt;% 
  ggplot(aes(x= screen_name, y= n))+
  geom_col()+
  coord_flip()+
  scale_y_continuous(breaks = seq(0,180, 20), labels = seq(0,180,20))+
  labs(x = &amp;quot;Screen name&amp;quot;, y = &amp;quot;Number of tweets&amp;quot;, title = &amp;quot;Top 15 users tweeting the word &amp;#39;elections&amp;#39; (◊ë◊ó◊ô◊®◊ï◊™)\nduring the 3rd Israeli elections&amp;quot;)+
  theme_ipsum_rc()+
  theme(panel.grid = element_blank(),
        panel.grid.major.y = element_blank())&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/elections-twitter/2020-03-09-israeli-elections-on-twitter_files/figure-html/unnamed-chunk-4-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Making updating exam grades easy with R</title>
      <link>/2020/02/15/update-exam-grades-easy-with-r/</link>
      <pubDate>Sat, 15 Feb 2020 00:00:00 +0000</pubDate>
      <guid>/2020/02/15/update-exam-grades-easy-with-r/</guid>
      <description>
&lt;script src=&#34;/rmarkdown-libs/kePrint/kePrint.js&#34;&gt;&lt;/script&gt;


&lt;p&gt;&lt;strong&gt;TL;DR&lt;/strong&gt; Instead of each time searching for an id in the xlsx template the university provides we make our own xlsx and merge between the two. I then run through two options of either saving the new data frame as an &lt;code&gt;.xlsx&lt;/code&gt; using the &lt;code&gt;{xlsx}&lt;/code&gt; package, and I show another option where I extract the new column I need using &lt;code&gt;write_clip&lt;/code&gt; from the &lt;code&gt;{clipr}&lt;/code&gt; package.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;‚ÄúProgress isn‚Äôt made by early risers. It‚Äôs made by lazy men trying to find easier ways to do something.‚Äù &lt;/br&gt; ‚Äï Robert Heinlein&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div id=&#34;whats-the-story&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;What‚Äôs the story?&lt;/h3&gt;
&lt;p&gt;The other day I had to update students‚Äô exams into a blank excel file. Every course exam each student gets an exam id. Their id is comprised from a number / number, for example, 26/1; 1/1; 42/15 and so forth. In our course of up to 70 students the left number goes all the way to the number of students in the exam class, and the right number goes up to 15 or 20 and starts again from 1.&lt;br /&gt;
This would make it easy to insert the grade for each id into the excel file that is already organized. However, since this is a new system and I was waiting to get access to download the excel I decided to open a new spreadsheet instead. Also, writing the id instead of looking it up in the excel file each time can save, in my opinion, a little time of searching.&lt;br /&gt;
So we have our spreadsheet which is not sorted, and we have the university‚Äôs spreadsheet which is sorted - how are we going to sync between them, considering our id column we wrote is recognized as a &lt;code&gt;character&lt;/code&gt; class? I know, let‚Äôs turn to &lt;code&gt;R&lt;/code&gt;&lt;a href=&#34;#fn1&#34; class=&#34;footnote-ref&#34; id=&#34;fnref1&#34;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;looking-at-our-data&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Looking at our data&lt;/h3&gt;
&lt;p&gt;Let‚Äôs start off with loading our packages:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(tidyverse)
# For reading xlsx files
library(readxl)
# To nicely display the tables in the following paragraph
library(kableExtra)
library(knitr)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now let‚Äôs read both files: Our spreadsheet with just the id and grade of each student we wrote in, and the other spreadsheet with the students‚Äô id and a numerical vector to sort by that the university provides.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;messy &amp;lt;- read_excel(&amp;quot;messy_grades.xlsx&amp;quot;)
clean &amp;lt;- read_excel(&amp;quot;clean.xlsx&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This gives us the following tables where on the left we have our &lt;strong&gt;messy&lt;/strong&gt; table we wrote and on the right our &lt;strong&gt;clean&lt;/strong&gt; table we want to merge to:&lt;/p&gt;
&lt;table class=&#34;table&#34; style=&#34;width: auto !important; float: left; margin-right: 10px;&#34;&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
id
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
grade
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
67/13
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
94
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
56/2
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
90
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
68/14
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
84
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
63/9
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
100
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
55/1
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
89
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
62/8
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
97
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;table class=&#34;table&#34; style=&#34;width: auto !important; margin-right: 0; margin-left: auto&#34;&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
id
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
participated
&lt;/th&gt;
&lt;th style=&#34;text-align:center;&#34;&gt;
number_for_sorting
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
1/1
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
V
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
1
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
2/2
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
V
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
2
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
3/3
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
V
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
3
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
4/4
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
4
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
5/5
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
NA
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
5
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
6/6
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
V
&lt;/td&gt;
&lt;td style=&#34;text-align:center;&#34;&gt;
6
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;br&gt;
So we now have several options:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Join between the two tables, save the clean table as a new xlsx and upload it to the University‚Äôs exam system.&lt;/li&gt;
&lt;li&gt;Join between the two tables, clip the column with the organized grades and paste it into the university‚Äôs sorted excel file.&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div id=&#34;option-1---merge-and-write-to-a-new-excel-file&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Option 1 - Merge and write to a new excel file&lt;/h3&gt;
&lt;p&gt;So the first option will be to merge the two tables into the clean one and save that as a new excel file using the &lt;code&gt;{xlsx}&lt;/code&gt; package:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;joined_tables &amp;lt;- messy %&amp;gt;% 
    right_join(clean)

xlsx::write.xlsx(joined_tables, &amp;quot;010210078-29012020C.xlsx&amp;quot;, showNA = FALSE)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Below is a screen shot of our new table:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/img/ta_efficient/xl.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;However, going with this approach I encountered that the new .xlsx file is saved with a new column of id numbers that we see in the screenshot. We can just delete that column and have our file all ready to go.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;option-2---clip-the-sorted-column-into-the-excel-file&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Option 2 - Clip the sorted column into the excel file&lt;/h3&gt;
&lt;p&gt;This time around I‚Äôll write a function for what we‚Äôll be doing: I want to join the tables but this time around I want to clip the column I need and then manually paste it in the original template excel file:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;clip_grades &amp;lt;- function(messy, clean){
  messy %&amp;gt;% 
    right_join(clean) %&amp;gt;% 
    pull(grade) %&amp;gt;% 
    clipr::write_clip()
}

clip_grades(messy, clean)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;which gives us the following:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/img/ta_efficient/clipgif.gif&#34; /&gt;&lt;/p&gt;
&lt;p&gt;That‚Äôs it!&lt;/p&gt;
&lt;p&gt;Well, more or less. We need to delete the ‚ÄòNA‚Äô that are copied from the function. Unfortunately I wasn‚Äôt able to delete them from within &lt;code&gt;R&lt;/code&gt;, so I manually delete them.&lt;/p&gt;
&lt;p&gt;As to which option is better, I think the first option is more efficient as we only need to delete the id column. However, using the &lt;code&gt;{xlsx}&lt;/code&gt; package is dependent on &lt;code&gt;{rJava}&lt;/code&gt;and having java installed on the computer from what I encountered. Option two can be a little messy and possibly yield mistakes if we copy and paste the new grades and then manually delete the &lt;code&gt;NA&lt;/code&gt; - your call.&lt;/p&gt;
&lt;div id=&#34;so-what-did-i-learn-here&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;So what did I learn here?&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;How to read and write an excel file.&lt;/li&gt;
&lt;li&gt;Using the &lt;code&gt;write_clip&lt;/code&gt; function which is amazingly easy.&lt;/li&gt;
&lt;li&gt;How to make updating exams easier üí™&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;/br&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#34;footnotes&#34;&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id=&#34;fn1&#34;&gt;&lt;p&gt;For confidentiality and other reasons I only left columns with information that can‚Äôt be linked to students (I also changed the grades altogether for this demonstration).&lt;a href=&#34;#fnref1&#34; class=&#34;footnote-back&#34;&gt;‚Ü©&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Visualizing Eliud Kichoge&#39;s new marathon record</title>
      <link>/2020/02/07/eliud-kichoge/</link>
      <pubDate>Fri, 07 Feb 2020 00:00:00 +0000</pubDate>
      <guid>/2020/02/07/eliud-kichoge/</guid>
      <description>


&lt;div class=&#34;figure&#34; style=&#34;text-align: center&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-1&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;new_record.jpg&#34; alt=&#34;_Eliud Kipchoge breaks the two-hour marathon barrier. Photo from the &#39;New York Times&#39;. Leonhard Foeger/Reuters _&#34; width=&#34;512&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 1: &lt;em&gt;Eliud Kipchoge breaks the two-hour marathon barrier. Photo from the ‚ÄòNew York Times‚Äô. Leonhard Foeger/Reuters &lt;/em&gt;
&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;table-of-contents&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Table of Contents&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#background&#34;&gt;Background&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#retrieving-data-from-wikipedia&#34;&gt;Retrieving data from wikipedia&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#warngling-the-data&#34;&gt;Warngling the Data&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#plot&#34;&gt;Plot&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#ggimage&#34;&gt;ggimage&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#plot-aesthetics&#34;&gt;Plot Aesthetics&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#final-annotation&#34;&gt;Final annotation&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#appendix&#34;&gt;Appendix&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;background&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Background&lt;/h2&gt;
&lt;p&gt;On saturday October 12, 2019, Eliud Kipchoge broke (unofficially) the two-hour marathon barrier üèÜ&lt;br /&gt;
I saw &lt;a href=&#34;https://twitter.com/neilfws/status/1182958246753009665&#34;&gt;Neil Saunders‚Äô Twitter post&lt;/a&gt; visualizing the new record and wanted to try and reproduce it with runners instead of points. In this post I‚Äôll walk through how I obtained the data from a Wikipedia page with &lt;code&gt;{rvest}&lt;/code&gt;, wrangled and tidied it and eventually plotted it using &lt;code&gt;{ggimage}&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;When I initially created the plot I mistakenly took the &lt;a href=&#34;https://en.wikipedia.org/wiki/Marathon_year_rankings&#34;&gt;Marathon year rankings&lt;/a&gt; from the Wikipedia webpage. That page showcases The yearly rankings and not the world records in general. In addition, I also changed the method of obtaining the data from first creating the plot to now. When I first did it I copied and pasted the table from Wikipedia into a &lt;code&gt;.csv&lt;/code&gt; file and worked with that. For that specific time point, where my experience with &lt;code&gt;R&lt;/code&gt; was extremly novice, I think it was adequate. This time around I gave scraping Wikipedia‚Äôs webpage a try which also renders a reproducible example.&lt;/p&gt;
&lt;p&gt;Let‚Äôs start with loading the packages we‚Äôll need:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(tidyverse)
library(rvest)
library(janitor)
library(lubridate)
library(ggimage)
library(hrbrthemes)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We‚Äôll use &lt;code&gt;{tidyverse}&lt;/code&gt; for tidy manipulation and plotting, &lt;code&gt;{janitor}&lt;/code&gt; for cleaning the column names, &lt;code&gt;{lubridate}&lt;/code&gt; for working with dates, &lt;code&gt;{ggimage}&lt;/code&gt; for a plot with images and &lt;code&gt;{hrbrthemes}&lt;/code&gt; for a nice quick aesthetic theme.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;retrieving-data-from-wikipedia&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Retrieving data from wikipedia&lt;/h2&gt;
&lt;p&gt;In order to view the new record in comparison to other world records, We‚Äôll turn to Wikipedia and see what we can find there.&lt;/p&gt;
&lt;div class=&#34;figure&#34; style=&#34;text-align: center&#34;&gt;&lt;span id=&#34;fig:wiki-ss&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;wikipage.png&#34; alt=&#34;_Wikipedia page of marathon world records_&#34; width=&#34;807&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 2: &lt;em&gt;Wikipedia page of marathon world records&lt;/em&gt;
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Here we can see that the webpage contains information about marathon records, where in the screenshot we see the men section. We only want the table with men‚Äôs records, so let‚Äôs get that:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;#The Wikipage we&amp;#39;ll need
wiki_url &amp;lt;- &amp;quot;https://en.wikipedia.org/wiki/Marathon_world_record_progression&amp;quot;

runners_wiki &amp;lt;- wiki_url %&amp;gt;% 
  read_html() %&amp;gt;% 
  html_nodes(xpath=&amp;#39;//*[@id=&amp;quot;mw-content-text&amp;quot;]/div/table[1]&amp;#39;) %&amp;gt;% 
  html_table(fill = TRUE) %&amp;gt;% 
  as.data.frame()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Using the &lt;code&gt;{rvest}&lt;/code&gt; package we are able to scrape the Wikipedia page for the table we wanted. Frankly, this is the first time I used &lt;code&gt;rvest&lt;/code&gt;, but I found a good example from &lt;a href=&#34;https://r-tastic.co.uk/post/exploring-london-crime-with-r-heat-maps/&#34;&gt;Kasia Kulma‚Äôs blog post&lt;/a&gt; exploring London crime with R heat maps. I used the &lt;em&gt;SelctorGadget&lt;/em&gt; which identified the page‚Äôs content as ‚Äúmw-content-text‚Äù. Using that id we looked for the tables (/div/table), specifically the first table &lt;code&gt;[1]&lt;/code&gt; of men world records we saw earlier in figure &lt;a href=&#34;#fig:wiki-ss&#34;&gt;2&lt;/a&gt;. Once we have the table we turn it into a dataframe for us to use.&lt;/p&gt;
&lt;p&gt;Alternatively, you can also use the following method to extract a table by extracting all tables from the Wikipedia page and choosing the first one:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;runners_wiki_alternative &amp;lt;- wiki_url %&amp;gt;% 
  read_html() %&amp;gt;%
  html_table(fill = TRUE) %&amp;gt;%
  .[[1]]&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This option extracts all table from the html page using &lt;code&gt;html_table()&lt;/code&gt;. Using this on the whole page parses the html tables into data frames nesting within a list object. Like before, &lt;code&gt;{rvest}&lt;/code&gt; makes it easy for us and if the tables have inconsistent number of values it requires (or demands?) us to fill them. Once we have the tables in a list object we can extract the one we need using &lt;code&gt;.[[1]]&lt;/code&gt;. The &lt;code&gt;.&lt;/code&gt; acts as a place holder for the previous object passed, in this case the list of tables we scraped. The &lt;code&gt;[[1]]&lt;/code&gt; following that calls for the first object within the list, but in the form of its core class, in this case a &lt;code&gt;class(runners_wiki_alternative)&lt;/code&gt;. If we‚Äôd use one square bracket &lt;code&gt;[1]&lt;/code&gt; it would return an object with the original class from which it was drawn, in this case a list which is not good for us here since we anyway want it as a dataframe.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;warngling-the-data&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Warngling the Data&lt;/h2&gt;
&lt;p&gt;Let‚Äôs look at our table to see what we have and what we‚Äôll need to do:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;head(runners_wiki, n = 3)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##        Time          Name   Nationality              Date
## 1 2:55:18.4  Johnny Hayes United States     July 24, 1908
## 2 2:52:45.4 Robert Fowler United States   January 1, 1909
## 3 2:46:52.8   James Clark United States February 12, 1909
##                    Event.Place   Source
## 1       London, United Kingdom IAAF[53]
## 2  Yonkers,[nb 5]United States IAAF[53]
## 3 New York City, United States IAAF[53]
##                                                                                                                                                                                            Notes
## 1 Time was officially recorded as 2:55:18 2/5.[54]Italian Dorando Pietri finished in 2:54:46.4, but was disqualified for receiving assistance from race officials near the finish.[55] Note.[56]
## 2                                                                                                                                                                                      Note.[56]
## 3                                                                                                                                                                                      Note.[56]&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;A little messey but that‚Äôs OK. What we‚Äôll need to visualize Eliud Kipchoge‚Äôs record is the Name, Time and Date of all runners. We‚Äôll start with cleaning our data:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;runners_clean &amp;lt;- runners_wiki %&amp;gt;% 
  clean_names() %&amp;gt;% 
  select(1,2,4)
str(runners_clean)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## &amp;#39;data.frame&amp;#39;:    50 obs. of  3 variables:
##  $ time: chr  &amp;quot;2:55:18.4&amp;quot; &amp;quot;2:52:45.4&amp;quot; &amp;quot;2:46:52.8&amp;quot; &amp;quot;2:46:04.6&amp;quot; ...
##  $ name: chr  &amp;quot;Johnny Hayes&amp;quot; &amp;quot;Robert Fowler&amp;quot; &amp;quot;James Clark&amp;quot; &amp;quot;Albert Raines&amp;quot; ...
##  $ date: chr  &amp;quot;July 24, 1908&amp;quot; &amp;quot;January 1, 1909&amp;quot; &amp;quot;February 12, 1909&amp;quot; &amp;quot;May 8, 1909&amp;quot; ...&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The &lt;code&gt;clean_names&lt;/code&gt; function cleans the column names making them easier to use. I then picked the columns we‚Äôll need using &lt;code&gt;select&lt;/code&gt;. Lastly, we want to look at the variables structure to see if we they need any manipulations. Yes, it seems both the time and date are not recognized appropriately (In this case they‚Äôre characters) - let‚Äôs fix that:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;runners_mutate &amp;lt;- runners_clean %&amp;gt;% 
  add_row(time = &amp;quot;1:59:40&amp;quot;, name = &amp;quot;Eliud Kipchoge&amp;quot;, date = &amp;quot;November 12, 2019&amp;quot;) %&amp;gt;% 
  mutate(run_period_raw = hms(time),
         run_duration = as.numeric(run_period_raw, &amp;quot;minutes&amp;quot;),
         run_year = year(mdy(date))) %&amp;gt;% 
  select(c(-date,-time))&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: 1 failed to parse.&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Let‚Äôs see what we did here. First I add Eliud Kipchoge‚Äôs new unofficial record as an observation into our dataframe. I then turned to the &lt;code&gt;{lubridate}&lt;/code&gt; package where I used the &lt;code&gt;hms&lt;/code&gt; function to mutate the time variable we had into a new variable called ‚Äòr_period_raw‚Äô. Although this cleans the variable, &lt;code&gt;hms&lt;/code&gt; transforms it into a &lt;code&gt;period&lt;/code&gt; object which I found a little difficult to use when we want to plot. What we need is to turn it into a numeric class which we did in our new variable ‚Äòrun_duration‚Äô. This will help us in plotting but I retained the period class variable as it makes it easier to read in this case.&lt;/p&gt;
&lt;p&gt;I then turned the date column into a Month-Day-Year variable using the &lt;code&gt;mdy&lt;/code&gt; function, which eventually I only extracted the year using &lt;code&gt;year&lt;/code&gt;. Lastly I discarded the old columns we don‚Äôt need anymore. We also recieved a warning sign that one observation didn‚Äôt parse. This was because the value in the cell didn‚Äôt match the pattern of the &lt;code&gt;hms&lt;/code&gt; fuction. The original pattern looked like this: May 26, 1909[nb 6]. All we want is the specific year which we‚Äôll probably anyway filter later so it‚Äôs no big deal, but let‚Äôs go ahead and manually add it if we decide to use it later:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;runners_mutate[5,4] &amp;lt;- 1909&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This brings us the following:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;ggplot(runners_mutate,aes(x = run_year, y = run_duration))+
  geom_point()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/eliud-kichoge/index_files/figure-html/unnamed-chunk-9-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Great, that‚Äôs a good start. Now we want to make it a little less crowded so we can easily insert an image of runners instead of points and not have it cluttered. In order to do that we‚Äôll look at each several years and lastly at 2019, the current record. First, let‚Äôs look at the years we have:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;runners_mutate %&amp;gt;% 
  pull(run_year)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##  [1] 1908 1909 1909 1909 1909 1909 1913 1913 1914 1920 1925 1929 1935 1935 1935
## [16] 1935 1947 1952 1953 1953 1954 1956 1958 1960 1963 1963 1963 1964 1964 1965
## [31] 1967 1969 1970 1974 1978 1980 1981 1984 1985 1988 1998 1999 2002 2003 2007
## [46] 2008 2011 2013 2014 2018 2019&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Using the &lt;code&gt;pull&lt;/code&gt; function we were able to extract the column we wanted, much similar to using the &lt;code&gt;runners_mutate$column_name&lt;/code&gt; approach. ‚ÄòUnfortunately‚Äô, we can‚Äôt filter exactly by round intervals (for example every exact 10 years) so we‚Äôll create a vector with specific years to filter by. Although it might sound trivial, make sure you‚Äôre assigning years that are observed in your data set, otherwise it‚Äôll filter only by the years you do have and not those you don‚Äôt.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;year_sub &amp;lt;- c(1908, 1920, 1929, 1947, seq(1960,1980,10), 1999, 2011, 2019)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Here we created a vector with values for every 15+- years[^1]. Now we can filter our new dataframe according to the years we want:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;runners_mutate &amp;lt;- runners_mutate %&amp;gt;% 
 filter(run_year %in% year_sub)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Using the &lt;code&gt;filter&lt;/code&gt; function with &lt;code&gt;%in%&lt;/code&gt; we discard anything from the &lt;code&gt;run_year&lt;/code&gt; column that‚Äôs not in the &lt;code&gt;year_sub&lt;/code&gt; vector. I find &lt;code&gt;%in%&lt;/code&gt; facsinating and extremely helpful when you want to look/filter several parameters. Basically, you can read it as ‚ÄúKeep all rows in ‚Äòrun_year‚Äô that match values in ‚Äòyear_sub‚Äô‚Äù.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;plot&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Plot&lt;/h2&gt;
&lt;div id=&#34;ggimage&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;ggimage&lt;/h3&gt;
&lt;p&gt;In order for us to plot a runner icon instead of points we need to load the images into our data frame as values for each observation. To do that we use the &lt;code&gt;{ggimage}&lt;/code&gt; package which we‚Äôll also use for the plot.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;runners_mutate &amp;lt;- runners_mutate %&amp;gt;% 
  mutate(run_image = &amp;quot;run.png&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;And now let‚Äôs look at our new plot:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;g &amp;lt;- ggplot(runners_mutate, aes(x = run_year, y = run_duration))+
  geom_image(aes(image = run_image), size = 0.05)+
  theme_ipsum_rc()
g&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/eliud-kichoge/index_files/figure-html/unnamed-chunk-14-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Not bad. I like the icons although the whole graph might be a bit misleading if readers perceive that these are the only records there are. However, this is a tutorial and we‚Äôll also add that note into our plot momentarily. You can adjust the size and other parameters of the images we plot, here for example I chose to adjust the size from its default. I also added &lt;code&gt;theme_ipsum_rc&lt;/code&gt; from the &lt;code&gt;{hrbrthemes}&lt;/code&gt; package for a quick aesthetic theme I like.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;plot-aesthetics&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Plot Aesthetics&lt;/h3&gt;
&lt;p&gt;So the plot so far looks nice, but we want it to be aesthetic and also to easily understand the progress of records across years. In order to do that, let‚Äôs turn to adjust both the y and x axis, and following that add some information to understand what we‚Äôre looking at:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;g1 &amp;lt;-  g +
    scale_x_continuous(name = &amp;quot;Year&amp;quot;,
                        limits = c(1900,2025),
                        breaks = seq(1900,2020,10),
                        labels = c(&amp;quot;1900&amp;quot;, paste0(&amp;quot;&amp;#39;&amp;quot;, seq(10,90,10)),&amp;quot;2000&amp;quot;,
&amp;quot;&amp;#39;10&amp;quot;,&amp;quot;&amp;#39;19&amp;quot;))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Here we added some nice x labels in a format that‚Äôs both concise and informative. I remember taking this from &lt;a href=&#34;https://github.com/LiamDBailey/TidyTuesday/blob/master/R/17_09_2019.R&#34;&gt;Liam Bailey‚Äôs&lt;/a&gt; &lt;a href=&#34;https://github.com/rfordatascience/tidytuesday&#34;&gt;#Tidytuesday&lt;/a&gt; plot a while back when i first made this visualiztion. What we did was teak the &lt;code&gt;scale_x_continuous&lt;/code&gt; by assigning a &lt;code&gt;name&lt;/code&gt; to the axis, expanding its &lt;code&gt;limits&lt;/code&gt;, added specific &lt;code&gt;breaks&lt;/code&gt; and then a &lt;code&gt;label&lt;/code&gt; for each break using &lt;code&gt;paste0&lt;/code&gt;. Note that you must have the same number of labels and breaks for the plot to render so it‚Äôs important to have the sequences identical in length; otherwise it‚Äôll return an error. With the &lt;code&gt;paste0&lt;/code&gt; we can add any value or observation and then ‚Äòstick‚Äô to it whatever else we want. Using that we are able to create years in the format of ‚Äô10 and so on. It is also possible to use the &lt;code&gt;{glue}&lt;/code&gt; package which I heard is very intuitive, maybe next post I‚Äôll give that a try.&lt;/p&gt;
&lt;p&gt;Next, let‚Äôs change our y duration axis:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;g2 &amp;lt;- 
  g1 + scale_y_time(name = &amp;quot;Time (hours)&amp;quot;,
                  limits = c(100,180),
                  breaks = seq(100,180,10),
                  labels = c(&amp;quot;1:40&amp;quot;,&amp;quot;1:50&amp;quot;, &amp;quot;2:00&amp;quot;, &amp;quot;2:10&amp;quot;,&amp;quot;2:20&amp;quot;,&amp;quot;2:30&amp;quot;,&amp;quot;2:40&amp;quot;, &amp;quot;2:50&amp;quot;, &amp;quot;3:00&amp;quot;))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;If you recall, we previously mutated the column we read from Wikipedia into a period class and a duration of minutes. using the &lt;code&gt;scale_*_time&lt;/code&gt; (either x or y instead of *) we can work with an &lt;code&gt;hms&lt;/code&gt; object. What we did is add a &lt;code&gt;name&lt;/code&gt;, expand a little the &lt;code&gt;limits&lt;/code&gt;, add &lt;code&gt;breaks&lt;/code&gt; and &lt;code&gt;labels&lt;/code&gt; same as before. This time around we used our breaks as minutes, so every 60 minutes represents an hour. I initially used hours as the numeric value, but then it makes it harder to break every 10 minutes (that‚Äôll mean breaks every 0.166‚Ä¶). For the labels I was having some problems automating it so I comprimised on manually inputting it; I guess sometimes you just have to choose your battles between automating and manualy inserting.&lt;/p&gt;
&lt;p&gt;Let‚Äôs finish up by adding a title, subtitle and integrating last aesthetics to our plot.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;g3 &amp;lt;- g2 +
  labs(title = &amp;quot;How does Eliud Kipchoge marathon score compare to previous yearly records?&amp;quot;,
       subtitle = &amp;quot;Points are world records for every 10-15 years. \nEliud Kipchoge is the first to break the two-hour barrier (unofficially), Great job!&amp;quot;)+
    theme(
      panel.grid.minor = element_blank(),
      panel.grid.major = element_line(colour = &amp;quot;gray75&amp;quot;, size = 0.1, linetype = &amp;quot;dashed&amp;quot;),
      plot.title = element_text(size = 14),
      plot.subtitle = element_text(size = 10)
      )&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;After adding some labs I tweaked a bit the gridlines using &lt;code&gt;panel.grid&lt;/code&gt; minor or major. You can play around with them to see which minimilize your plot in the perfect way. I chose to leave the major grid lines since I find it easier to read the values with them. Although we defined a theme earlier on we can still tweak it by adding another &lt;code&gt;theme&lt;/code&gt; argument to the previous one as we just did.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;final-annotation&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Final annotation&lt;/h3&gt;
&lt;p&gt;Lastly, we want the new record to be evident and stand out in a first glance. Here I was somewhat debating between using a regular &lt;code&gt;geom_point&lt;/code&gt; instead of the &lt;code&gt;geom_image&lt;/code&gt; because then we could easily use a vertical line to highlight the 2:00 hour threshold. Since a line in this case will cut right through the icon, let‚Äôs use an arrow annotation instead.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;g4 &amp;lt;- g3 +
  geom_curve(aes(x = 2018, y = 120, xend = 2015, yend = 113),
             colour = &amp;quot;black&amp;quot;, size = 0.9, curvature = 0.5,
             arrow = arrow(length = unit(2,&amp;quot;mm&amp;quot;), type = &amp;quot;closed&amp;quot;))+
  annotate(&amp;quot;text&amp;quot;, x=2010, y= 105, 
           label = &amp;quot;Eliud Kipchoge\n12.10.2019\n1:59:40&amp;quot;,
           color = &amp;quot;black&amp;quot;, size = 3, hjust = 0)

g4&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/eliud-kichoge/index_files/figure-html/unnamed-chunk-18-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;And voila!&lt;/p&gt;
&lt;p&gt;In our final touches we added both an arrow and text to explain what we‚Äôre seeing. I decided to go with a &lt;code&gt;geom_curve&lt;/code&gt; arrow where we can set the start and end of the arrow along with the kind of curve we want. We then set the curve to be &lt;code&gt;arrow&lt;/code&gt; and adjust its length. You can also use a closed head arrow, for more on that read on &lt;code&gt;?arrow&lt;/code&gt; as part of the &lt;code&gt;geom_curve&lt;/code&gt; or &lt;code&gt;geom_segment&lt;/code&gt; you can use here.&lt;/p&gt;
&lt;p&gt;That‚Äôs it, seems like were good to go. &lt;strong&gt;Great job for Elihud Kipchoge&lt;/strong&gt; üëè&lt;br /&gt;
&lt;/br&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;appendix&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Appendix&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;When I initially created this visulization I was just starting with &lt;code&gt;R&lt;/code&gt;. I first created 11 slots, added 1921, the sequence of 1930-2010 and then a 2019 (reminder: When I first created this viz I took a different dataset altogether). Little did I know how to properly use the &lt;code&gt;c()&lt;/code&gt; function that we used in the current post.&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;year.sub &amp;lt;- vector (&amp;quot;double&amp;quot;, 11)
year.sub[1] &amp;lt;- 1921
year.sub[2:10] &amp;lt;- seq(1930,2010,10)
year.sub[11] &amp;lt;- 2019&lt;/code&gt;&lt;/pre&gt;
&lt;center&gt;
&lt;a href=&#34;#top&#34;&gt; Back to top&lt;/a&gt;
&lt;/center&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>The Tidytuesday project</title>
      <link>/2020/02/03/the-tidytuesday-project/</link>
      <pubDate>Mon, 03 Feb 2020 00:00:00 +0000</pubDate>
      <guid>/2020/02/03/the-tidytuesday-project/</guid>
      <description>


&lt;div id=&#34;what-is-tidytuesday&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;&lt;strong&gt;What is TidyTuesday?&lt;/strong&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;‚ÄúA weekly data project aimed at the R ecosystem. As this project was borne out of the R4DS Online Learning Community and the R for Data Science textbook, an emphasis was placed on understanding how to summarize and arrange data to make meaningful charts with ggplot2, tidyr, dplyr, and other tools in the tidyverse ecosystem. However, any code-based methodology is welcome - just please remember to share the code used to generate the results.‚Äù&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;You can read more about it &lt;a href=&#34;https://github.com/rfordatascience/tidytuesday&#34;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Basically, every week the R4DS community publishes a &lt;strong&gt;new data set&lt;/strong&gt; where the R community (or any code-based methdogology) is welcome to &lt;strong&gt;analyze&lt;/strong&gt; and &lt;strong&gt;visualize&lt;/strong&gt; the data.
When I started learning R I saw it as a great opportunity to practice plotting and analzying various datasets; it‚Äôs what get me motivated and fascinated with R. Every week you‚Äôre challenged with a new data set and get to see how others have analyzed it.&lt;/p&gt;
&lt;p&gt;Whenever I have some free time I like to join in and give it a go. If you‚Äôre looking to get some practice or enjoy analyzing the same data set as others - Join the party, there‚Äôs much to learn!&lt;br /&gt;
&lt;/br&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;plots&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Plots&lt;/h2&gt;
&lt;p&gt;Below are graphs I made, organized in a descending order by date. Some I‚Äôm more proud of than others, but I choose to display all of them in case someone finds anything useful üòÑ
&lt;/br&gt;&lt;/p&gt;
&lt;div id=&#34;section&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;&lt;strong&gt;20.01.2020&lt;/strong&gt;&lt;/h3&gt;
&lt;a href=&#34;https://github.com/AmitLevinson/TidyTuesday/blob/master/2020/week4_spotify_songs/spotify_songs.R&#34;&gt;Link to code&lt;/a&gt;
&lt;p align=&#34;center&#34;&gt;
&lt;img src = &#34;/img/tt/spotify.png&#34; width = &#34;700&#34;&gt;
&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;section-1&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;&lt;strong&gt;22.12.2019&lt;/strong&gt;&lt;/h3&gt;
&lt;a href=&#34;https://github.com/AmitLevinson/TidyTuesday/blob/master/Week51_adopted_dogs/adopted_dogs.R&#34;&gt;Link to code&lt;/a&gt;&lt;br /&gt;

&lt;p align=&#34;center&#34;&gt;
&lt;img src = &#34;/img/tt/total_breed.png&#34; width = &#34;700&#34;&gt;
&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;section-2&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;&lt;strong&gt;11.12.2019&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/AmitLevinson/TidyTuesday/blob/master/Week50_diseases/diseases.R&#34;&gt;Link to code&lt;/a&gt;&lt;/p&gt;
&lt;p align=&#34;center&#34;&gt;
&lt;img src = &#34;/img/tt/measles.gif&#34; width = &#34;700&#34;&gt;
&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;section-3&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;&lt;strong&gt;5.12.2019&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/AmitLevinson/TidyTuesday/blob/master/Week49_parking_tickets/parking_tickets.R&#34;&gt;Link to code&lt;/a&gt;&lt;/p&gt;
&lt;p align=&#34;center&#34;&gt;
&lt;img src = &#34;/img/tt/parking_tickets_hours.png&#34; width = &#34;700&#34;&gt;
&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;section-4&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;&lt;strong&gt;20.11.2019&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/AmitLevinson/TidyTuesday/blob/master/Week47_nz_birds/nz_birds.Rmd&#34;&gt;Link to code&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/img/tt/nz_bird_vote.png&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;section-5&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;&lt;strong&gt;6.11.2019&lt;/strong&gt;&lt;/h3&gt;
&lt;a href=&#34;https://github.com/AmitLevinson/TidyTuesday/blob/master/Week45_bike_walk/bike_walk.Rmd&#34;&gt;Link to code&lt;/a&gt;
&lt;p align=&#34;center&#34;&gt;
&lt;img src=&#34;/img/tt/bikers_and_walkers.png&#34; width=&#34;700&#34;&gt;
&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;section-6&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;&lt;strong&gt;31.10.2019&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/AmitLevinson/TidyTuesday/blob/master/Week44_NYC_Squerrils/Squirrels.Rmd&#34;&gt;Link to code&lt;/a&gt;&lt;/p&gt;
&lt;p align=&#34;center&#34;&gt;
&lt;img src=&#34;/img/tt/Central_park_squirrel.png&#34; width=&#34;700&#34;&gt;
&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;section-7&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;&lt;strong&gt;22.10.2019&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/AmitLevinson/TidyTuesday/blob/master/Week43_Horror_Films/Horror_dis.R&#34;&gt;Link to code&lt;/a&gt;&lt;/p&gt;
&lt;p align=&#34;center&#34;&gt;
&lt;img src=&#34;/img/tt/horror_movie_length.png&#34; width=&#34;700&#34;&gt;
&lt;/p&gt;
&lt;p&gt;&lt;/br&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;section-8&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;&lt;strong&gt;9.10.2019&lt;/strong&gt;&lt;/h3&gt;
&lt;a href=&#34;https://github.com/AmitLevinson/TidyTuesday/blob/master/Week41_Power_lifting/ipf.R&#34;&gt;Link to code&lt;/a&gt;
&lt;p align=&#34;center&#34;&gt;
&lt;img src=&#34;/img/tt/Max_lift.jpeg&#34; width=&#34;700&#34;&gt;
&lt;/p&gt;
&lt;p&gt;&lt;/br&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;section-9&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;&lt;strong&gt;6.10.2019&lt;/strong&gt;&lt;/h3&gt;
&lt;a href=&#34;https://github.com/AmitLevinson/TidyTuesday/blob/master/Week40_All%20the%20Pizza/Barstool_Top_2_Percent.R&#34;&gt;Link to code&lt;/a&gt;
&lt;p align=&#34;center&#34;&gt;
&lt;img src=&#34;/img/tt/Barstool_rating.png&#34; width=&#34;700&#34;&gt;
&lt;/p&gt;
&lt;p&gt;&lt;/br&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;section-10&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;&lt;strong&gt;28.9.2019&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/AmitLevinson/TidyTuesday/blob/master/2_Week39_SchoolDiversity/School_Diversity_Updated.R&#34;&gt;Link to code&lt;/a&gt;&lt;/p&gt;
&lt;p align=&#34;center&#34;&gt;
&lt;img src=&#34;/img/tt/Ethnic_div_revised.png&#34; width=&#34;700&#34;&gt;
&lt;/p&gt;
&lt;p&gt;&lt;/br&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;section-11&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;&lt;strong&gt;22.9.2019&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/AmitLevinson/TidyTuesday/blob/master/1_Week38_Number%20of%20Visitors/National%20Parks.R&#34;&gt;Link to code&lt;/a&gt;&lt;/p&gt;
&lt;p align=&#34;center&#34;&gt;
&lt;img src=&#34;/img/tt/National_Parks.png&#34; width=&#34;700&#34;&gt;
&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;#top&#34;&gt; Back to top&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Mapping bomb shelters in Be&#39;er-Sheva, IL</title>
      <link>/2020/01/14/bomb-shelters/</link>
      <pubDate>Tue, 14 Jan 2020 00:00:00 +0000</pubDate>
      <guid>/2020/01/14/bomb-shelters/</guid>
      <description>


&lt;p&gt;I‚Äôve been wanting to learn how to use maps in R for a while before creating the map in this post. Seeing dataframes with longitude and latitude coordinates on various occasions on &lt;a href=&#34;https://github.com/rfordatascience/tidytuesday&#34;&gt;#Tidytuesday&lt;/a&gt; encouraged me to do so.&lt;br /&gt;
A day before this visualizaiton, I discovered our municupality‚Äôs open access data &lt;a href=&#34;https://www.beer-sheva.muni.il/OpenData/Pages/default.aspx&#34;&gt;website&lt;/a&gt;. In this website you can find various datasets like street light coordinates, bomb shelters spread out in the city and more. A day after discovering it Israel, the country I live in, was fired missiles at. I decided to take the opportunity and map some of the shelters around my house. You know, just in case.&lt;/p&gt;
&lt;p&gt;Let‚Äôs begin with the packages we‚Äôll need:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;#for data manipulation
library(tidyverse)
#for a nice map
library(ggmap)
#for reading and working with .geojson file
library(geojsonio)
library(sp)
#for integrating a nice font
library(extrafont)&lt;/code&gt;&lt;/pre&gt;
&lt;div id=&#34;loading-and-tidying-the-data&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Loading and tidying the data&lt;/h3&gt;
&lt;p&gt;I initially tried using the &lt;code&gt;.csv&lt;/code&gt; file they have on their webiste but I was having too much trouble with the Hebrew so I decided to try and work with the &lt;code&gt;geojsonio&lt;/code&gt; package. I had no idea how to work with a &lt;code&gt;.geojson&lt;/code&gt; file or frankly how to work with maps in general. To my save, i found this incredible blog by &lt;a href=&#34;https://randomjohn.github.io/r-geojson-srt/&#34;&gt;John Johnson&lt;/a&gt; to help me transform a ‚Äògeomjson‚Äô file to a dataframe you can work with.&lt;/p&gt;
&lt;p&gt;Let‚Äôs begin:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;#read the .geojson file
my_geojson &amp;lt;- &amp;quot;shelters.geojson&amp;quot;
#convert the .geojson file to an sp object
data_json &amp;lt;- geojson_read(my_geojson, what = &amp;quot;sp&amp;quot;)
#now we can convert it to a nice data frame
shelters &amp;lt;- as.data.frame(data_json)
#last tidying of the column names
names(shelters)[6:7] &amp;lt;- c(&amp;quot;long&amp;quot;, &amp;quot;lat&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;What we did was load the geojson file, read it as an ‚Äòsp‚Äô object and then turn it into to a dataframe. I changed the names so that it‚Äôll be easier to read the columns. we could also use &lt;code&gt;dplyr::rename&lt;/code&gt; but I liked the base R function Johnson used in his blog so I‚Äôll stick with that.&lt;br /&gt;
let‚Äôs look at the top 3 observations of our new data frame:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;##       long      lat        name X.U.05E7..U.05D5..U.05D3._.U.05E1.
## 1 34.80821 31.25902  &amp;lt;U+05D2&amp;gt;/2                                 17
## 2 34.80789 31.25980  &amp;lt;U+05D2&amp;gt;/1                                 17
## 3 34.80937 31.25925 &amp;lt;U+05D2&amp;gt;/25                                 17
##                elc group_ F_.U.05E6..U.05D5..U.05D5..U.05EA.
## 1 &amp;lt;U+05D9&amp;gt;&amp;lt;U+05E9&amp;gt;      0                                   
## 2 &amp;lt;U+05D9&amp;gt;&amp;lt;U+05E9&amp;gt;      0                                   
## 3 &amp;lt;U+05D9&amp;gt;&amp;lt;U+05E9&amp;gt;      0&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ugh, well the names weren‚Äôt read well into &lt;code&gt;R&lt;/code&gt;. While this isn‚Äôt a big issue to resolve, I don‚Äôt find it necessary for the final piece. the names of the shelters are anyway in Hebrew and only represnt a letter and some sort of number (for e.g, A/23, only in Hebrew). Therefore we‚Äôll leave it as is since what I‚Äôm interested in is the longitude and latitude coordinations and for that we don‚Äôt need the character column.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;retrieving-the-map&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Retrieving the map&lt;/h3&gt;
&lt;p&gt;So we have our data frame with long and lat points, let‚Äôs get our map. I want a map that can be readable in terms of streets and roads, therefore I‚Äôll give the &lt;code&gt;ggmap&lt;/code&gt; package a try&lt;a href=&#34;#fn1&#34; class=&#34;footnote-ref&#34; id=&#34;fnref1&#34;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/a&gt;. Google requires you to register in order to recieve an API key to pull maps to plot. Unfortunately I won‚Äôt cover how to regiser in this blog post but I‚Äôm sure you can find plenty of tutorials addressing it online.&lt;br /&gt;
Let‚Äôs get Be‚Äôer-Sheva‚Äôs map:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;b7_map &amp;lt;- get_map(location = c(34.7913 , 31.25181), 
              zoom = 13, scale = 2, maptype = &amp;quot;roadmap&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;What we did here was use the &lt;code&gt;get_map&lt;/code&gt; function to pull the map according to the long and lat coordinates I gave it of Be‚Äôer-Sheva. You should first pass the longitude and then the latitude in the &lt;code&gt;location&lt;/code&gt; argument. In addition you can change other features such as the zoom level, the maptype and more as we saw here (See &lt;code&gt;?get_map&lt;/code&gt; for more info).&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;plot&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Plot&lt;/h3&gt;
&lt;p&gt;Now that we have our data set ready and the map as an object we can go on to plot it. ggmap extends ggplot features so we can run the data frame smoothly into the &lt;code&gt;ggmap&lt;/code&gt; function:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;ggmap(b7_map)+
  geom_point(shelters, mapping = aes(long,lat),
            color = &amp;quot;red&amp;quot;, size = 0.3, shape = 15)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/bomb-shelters/index_files/figure-html/unnamed-chunk-5-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;What we did was pass the b7_map as an object into the &lt;code&gt;ggmap&lt;/code&gt; function and add a geom, in this case &lt;code&gt;geom_point&lt;/code&gt; representing our shelter coordinates. However, this map doesn‚Äôt really help me in a time of need since it doesn‚Äôt show &lt;em&gt;my address&lt;/em&gt; clearly.&lt;/p&gt;
&lt;p&gt;Let‚Äôs try zooming in so that we can see what we‚Äôre looking at:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;#retreiving a new map with a greater `zoom`
b7_map_zoom &amp;lt;- get_map(location = c(34.7913 , 31.25181), 
                    zoom = 16, scale = 2, maptype = &amp;quot;roadmap&amp;quot;)

p &amp;lt;- ggmap(b7_map_zoom)+
geom_point(shelters, mapping = aes(long,lat), color = &amp;quot;red&amp;quot;,
           size = 3, shape = 15)
p&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/bomb-shelters/index_files/figure-html/unnamed-chunk-6-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Much nicer and clearer. Using the zoom option in &lt;code&gt;get_map&lt;/code&gt; enables to center more on where I want. Great, this shows me some bomb shetlers I have around me in a time of need. Let‚Äôs add some fine tuning for our theme:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;p+  
#for the title, caption and removing the X and Y axis
  labs (title = &amp;quot;Neighborhood B, Beer-Sheva, Israel, bomb shelters&amp;quot;,
        x = NULL, y = NULL,
        caption = &amp;quot;data: www.beer-sheva.muni.il | @Amit_Levinson&amp;quot;)+
  theme_minimal()+
  theme(text = element_text(family = &amp;quot;Microsoft Tai Le&amp;quot;),
    #Changing the position of the title
    plot.title = element_text(hjust = 0.5, size = 20, face = &amp;quot;bold&amp;quot;),
    axis.text = element_blank(),
    plot.caption = element_text(size = 9, face = &amp;quot;italic&amp;quot;, hjust = 0),
    panel.border = element_rect(color = &amp;quot;black&amp;quot;, size=2, fill = NA)
  )&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/bomb-shelters/index_files/figure-html/unnamed-chunk-7-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Perfect, I can now save the plot and distribute it if someone needs it.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;ggsave(&amp;quot;shelters_b_eng.png&amp;quot;, width = 8, height = 8)&lt;/code&gt;&lt;/pre&gt;
&lt;center&gt;
&lt;blockquote class=&#34;twitter-tweet&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;1.  I&amp;#39;ve been wanting to learn to plot maps in &lt;a href=&#34;https://twitter.com/hashtag/rstats?src=hash&amp;amp;ref_src=twsrc%5Etfw&#34;&gt;#rstats&lt;/a&gt;&lt;br&gt;2. Yesterday I encountered open data our municipality publishes&lt;br&gt;3. Today missiles are fired towards Israel in response to assassination of a top terrorist.&lt;br&gt;&lt;br&gt;1+2+3: Plotting bomb shelter locations near where I live&lt;a href=&#34;https://twitter.com/hashtag/ggmap?src=hash&amp;amp;ref_src=twsrc%5Etfw&#34;&gt;#ggmap&lt;/a&gt; &lt;a href=&#34;https://t.co/4Irz0ZKuZr&#34;&gt;pic.twitter.com/4Irz0ZKuZr&lt;/a&gt;&lt;/p&gt;&amp;mdash; Amit Levinson (@Amit_Levinson) &lt;a href=&#34;https://twitter.com/Amit_Levinson/status/1194274713759039488?ref_src=twsrc%5Etfw&#34;&gt;November 12, 2019&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async src=&#34;https://platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;

&lt;/center&gt;
&lt;/div&gt;
&lt;div class=&#34;footnotes&#34;&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id=&#34;fn1&#34;&gt;&lt;p&gt;For a first map I decided to go with a static one, but an interactive one can defenitely be a 2.0 version of this blog. Hopefully we won‚Äôt need it.&lt;a href=&#34;#fnref1&#34; class=&#34;footnote-back&#34;&gt;‚Ü©&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</description>
    </item>
    
  </channel>
</rss>
