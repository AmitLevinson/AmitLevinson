---
title: Israeli elections on twitter
author: Amit Levinson
date: '2020-03-09'
slug: israeli-elections-on-twitter
categories: []
tags: []
subtitle: ''
summary: ''
authors: []
lastmod: '2020-03-09T19:29:42+02:00'
featured: no
draft: true
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
editor_options: 
  chunk_output_type: console
codefolding_show: show
---

```{r setup, include=FALSE, message=FALSE}
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning = FALSE)
```

Israel just had its 3rd election in a row on March 2, 2020.
This is because our Knesset (Hebrew term for house of representatives) wasn't able to form or hold a government after the previous elections. As I won't get into the politics of why they didn't succeed thus far (get it? politics :wink:), I do want to take the opportunity and analyze some tweets posted in the time before and after the elections.

### Gathering the data <i class="fab fa-twitter"></i>

Twitter's API only always scraping for free 6-9 days back. therefore I scraped the data already on March 7, 2020 and saved it for later use. To gather the tweets we can use the `{rtweet}` package which is amazingly easy to use ([Check out its website](https://rtweet.info/)).  

Let's start with the packages we'll use:

```{r}
library(rtweet)
library(tidyverse)
library(tidytext)
library(hrbrthemes)
```

Next we'll gather the tweets we need:

```{r echo = FALSE}
# Not run
# elections_raw <- search_tweets(
#  "בחירות", n = 250000, retryonratelimit = TRUE
# )
elections <- readRDS("election_tweets.rds")
# elections <- election_tweets
```

As I mentioned earlier I already scraped the data to save it but wrote it here in case you're wondering how we gather them. I used only one term, which in hebrew is "elections", and gathered all tweets using that word.

Before we begin, I will say this post doesn't aim to be representative of the discussions that were held during the election period. As a matter of fact, nor does it aim to be representative of the twitter discussion. this is due for several reasons:  
1. Twitter isn't common in Israel at all. I'm not sure what's the usage rate but it's definitely not representative of the Israel population.  
2. I searched for only one word - elections (in Hebrew) - which yielded some 16,000 tweets. This is definitely not a large enough dataset for a representation.

With that said, the data gathered provides an opportunity to look at some Twitter data from the elections period. 

### Let's begin

First, let's see how the tweets distribute across the time span we searched for. we can create a quick time plot using the `ts_plot()` from the `{rtweet}` package:
```{r}
elections %>% 
  ts_plot("2 hours")+
  theme_ipsum_rc()+
  scale_x_datetime(date_breaks = "1 day",date_labels = "%d %b")+
    labs(x= NULL, y = NULL,
       title = "Frequency of tweets throughout the Israeli elections",
       subtitle = "Tweets are counts aggregated using a two-hour interval.\nonly tweets with the word 'elections' (in Hebrew) were gathered")+
  geom_text(aes(x = as.POSIXct("2020-03-02 22:10:00"), y = 425, label = "10 PM:\nClosing of\npolls"),
            hjust = 0, size = 3, family="Courier New")+
  geom_vline(xintercept = as.POSIXct("2020-03-02 22:00"),linetype = "dashed", size = 1)
```

Intersting, we see the number of tweets during the closing time is equivalent to that of XXXX. 

### Users with most tweets

Next, let's look at who tweeted the most:
```{r}
elections %>% 
  count(screen_name, sort = T) %>% 
  slice(1:15) %>% 
  mutate(screen_name = reorder(screen_name,n)) %>% 
  ggplot(aes(x= screen_name, y= n))+
  geom_col()+
  coord_flip()+
  scale_y_continuous(breaks = seq(0,180, 20), labels = seq(0,180,20))+
  labs(x = "Screen name", y = "Number of tweets", title = "Top 15 users tweeting the word 'elections' during the 3rd Israeli elections")+
  theme_ipsum_rc()+
  theme(panel.grid = element_blank(),
        panel.grid.major.y = element_blank())
```

### Most liked and retweeted

Let's have a look at which tweet was **most liked**. Twitter doesn't have 'likes' but instead 'favorite', or at least in the data that is collected:
```{r fig.align="center"}
get_most <- function(var){
elections %>% 
  arrange(desc({{var}})) %>% 
    .[1,] %>% 
    pull(status_id) %>% 
  blogdown::shortcode('tweet',.)
}

get_most(favorite_count)
```

The tweet is by 'Amit Segal', an Israeli newsreporter. The tweet says: "More than anything, I'm glad there won't be anymore elections for my family that suffered in honors a year and a quarter, Reut, Ivri and Inbar :heart_eyes:"

Now let's look at the **most retweeted**:

```{r}
get_most(retweet_count)
```


## Text Analysis

bla bla


```{r include = FALSE}
Sys.setlocale("LC_ALL", "Hebrew")
library(wordcloud2)
```


```{r}
election_token <- elections %>% 
  unnest_tokens(word, text) %>% 
  select(word) %>% 
  count(word, sort = T) %>% 
  filter(n>= 200, !grepl("([a-z]+)", word))

wordcloud2(election_token, color = "blue")
```





rt %>% 
  unnest_tokens(word, text) %>% 
  select(word) %>% 
  count(word, sort = T) %>% 
  filter(!grepl("[a-z]", word), n > 1200) %>%
  mutate(word = reorder(word, n)) %>% 
  ggplot(aes(x = word, y = n))+
  geom_col()+
  coord_flip()

hebrew_tokens <- read_csv("hebrew_tokens.csv")
stop_words <- hebrew_tokens %>% 
  unnest_tokens(word,`X1`) %>% 
  select(word)

rt_elections_token %>% 
  filter(n > 600, word != "בחירות") %>% 
  anti_join(stop_words) %>% 
  mutate(word = reorder(word, n)) %>% 
  ggplot(aes(x = word, y = n))+
  geom_col()+
  coord_flip()
  

