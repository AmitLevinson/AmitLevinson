---
title: An SQL interview question to learn from
author: Amit Levinson
date: '2021-07-08'
slug: a-great-sql-questions
categories: []
tags: []
subtitle: ''
summary: ''
authors: []
lastmod: ''
featured: no
image:
  caption: ''
  focal_point: ''
  preview_only: yes
draft: true
projects: []
---

<script src="{{< blogdown/postref >}}index_files/header-attrs/header-attrs.js"></script>


<p>Structure:</p>
<div id="intro" class="section level2">
<h2>Intro</h2>
<ul>
<li>Intro on job search process</li>
</ul>
<p>During the first half of 2021, as I was finishing up my M.A. thesis, I started searching for a job in Data Analytics. <a href="https://amitlevinson.com/blog/my-year-in-r/">My journey into analytics was through learning R</a> and I realized I had to learn some SQL, or at least familiarize myself with it.</p>
<p>Most of the SQL interview questions were pretty good. They cheked if you knew how to solve A or use something such as a window function, Having, LEAD, etc. But one question I was really fond of and thought about it since; this blog post details the question and several answers to it.</p>
<p><strong>The question and data do not represent my current employer.</strong> The data used here is made up and the question came from a different company. While not necessary, some SQL knowledge is useful to understanding the answers’ syntax.</p>
</div>
<div id="the-interview-question" class="section level2">
<h2>The Interview question</h2>
<p>You receive a dataset with sellers’ names, products they sell, and the total sum of sales for each of their products. For each seller, return their name, the highest amount sold and the product corresponding to that amount.</p>
<p>In other words, given the following data:</p>
<p>return the following table:</p>
<div id="why-not-just-a-simple-group-by" class="section level3">
<h3>Why not just a simple GROUP BY?</h3>
<p>A question that might come to mind is why not use a simple <code>GROUP BY</code> and return the <code>MAX</code> value. The issue is using <code>GROUP BY</code> we retrieve only the information that is aggregated. That is, if we group by the sellers name and return the max we won’t get the product name. Alternatively, if we <code>GROUP BY</code> the seller and product name and return the <code>MAX</code> value we’ll get the information for each seller and every product of theirs.</p>
<p>SHOW BOTH Queries</p>
<ul>
<li><p>various questions</p></li>
<li><p>Not representing my employer</p></li>
<li><p>Some basic knowledge of SQL (or R also if you ask me) can help</p></li>
</ul>
</div>
</div>
<div id="the-case" class="section level2">
<h2>The case</h2>
<ul>
<li><p>show the case with the question</p></li>
<li><p>provide the question with another one - reframed</p></li>
</ul>
</div>
<div id="solutions" class="section level2">
<h2>Solutions</h2>
<div id="window-functions" class="section level3">
<h3>1. Window functions</h3>
</div>
<div id="self-join" class="section level3">
<h3>2. Self Join</h3>
</div>
<div id="correlated-subquery" class="section level3">
<h3>3. Correlated subquery</h3>
</div>
</div>
